# 信息收集

## 一、信息收集的概念

信息收集对于渗透测试前期来说是非常重要的，尽可能的收集目标的信息，包括域名、IP、端口、管理员信息等等，通常先做加法，后做减法。因为只有我们掌握了目标网站或目标主机足够多的信息之后，我们才能更好地对其进行漏洞检测。

渗透测试者可以使用的信息收集方法包括公开来源信息查询、Google Hacking、社会工程学、网络踩点、扫描探测、被动监听、服务查点等。

而对目标系统的情报探查能力是渗透测试者一项非常重要的技能，信息搜集是否充分在很大程度上决定了渗透测试的成败，因为如果你遗漏关键的情报信息，你将可能在后面的阶段里一无所获。

### 信息收集分类:

主动信息收集和被动信息收集。

#### 主动信息收集

主动信息搜集是与目标主机进行直接交互，从而拿到目标信息。通过直接访问、扫描网站，这种流量将流经网站。例如：扫描、子域名挖掘等。

#### 被动信息收集

通过第三方服务来获取相关信息，例如：搜索引擎、Google搜索等。

### 收集内容

服务器的配置信息网站信息（网站注册人、目标网站系统、目标服务器系统、目标网站相关子域名、目标服务器开放的端口等）

- 域名信息：收集域名信息，如，URL、IP、注册商家、注册人联系方式等；
- 子域名：收集指定域名的三级、四级等子域名信息、主要结合业务去收集，采用爆破、搜索引擎、证书等方式去实施采集；
- 端口信息探测：探测目标服务上开启的服务，以及服务的banner信息
- 敏感信息收集：探测目标资源的站点服务结构、js接口、页面包含的链接、客户信息、邮箱等内容
- 安全防护判断：通过工具和手工的方式判断目标资源中开启的防护设备，如不同类型的WAF、防火墙、EDR、杀软等
- 指纹识别：识别目标资源的站点CMS类型，中间件类型，容器类型，服务类型，系统类型等
- 旁站以及C段探测：收集目标站点上开启的其他的网站信息，一台服务器上可能搭载多个站点，C段也是考虑的目的
- 扫描敏感目录和文件：目标站点中可能存在敏感文件和目录，通过目录扫描工具获取这些敏感文件和目录，如phpinfo、robots.txt、readme.md、备份文件等等
- 组织架构信息：获取目标对象的内容人力资源架构，可实施社工、近缘攻击等测试；
- 历史漏洞信息：通过目标资源的banner信息来判断目标可能存在的漏洞问题，如根据CMS版本来查找exploit
- 社工信息：以欺骗、诱导等方式获取的社工信息，如目标人的身份信息、邮箱信息、管控系统的密码等
- 其他信息：微信小程序、APP、合作商、外包商、vpn等等

## 二、信息收集的内容

- 域名：子域名、真实IP、CDN、注册信息（姓名、电话、邮箱、地址）；
- 网站敏感信息：cms指纹信息、WAF、旁站、C段、敏感目录、敏感信息、源码泄露、网站后台信息等；
- 社会工程学
- 服务器：操作系统类型、端口服务；
- 网站架构：数据库类型、网站容器、开发语言；

### 2-1 域名

#### 域名信息收集

##### 域名信息收集

查询可以获取网站注册人的信息，包括注册商、联系人、联系邮箱、联系电话、创建时间等。

可以进行邮箱反查域名，联系电话反查，分析出此域名的注册人还注册过哪些域名，为而后的目标转移，社工钓鱼、邮箱爆破、域名劫持，寻找旁站做准备。

###### 域名相关性

查询域名注册邮箱

通过域名查询备案号

通过备案号查询域名

反查注册邮箱

反查注册人

通过注册人查询到的域名在查询邮箱

通过上一步邮箱去查询域名

查询以上获取出的域名的子域名

###### 域名信息收集方法

1、whois查询：通过whois来对域名信息进行查询，可以查到注册上、注册人、邮箱、DNS解析服务器、注册人联系电话等，推荐线上一些查询网站，直接输入目标站点即可查询到相关信息

2、备案信息查询:国内网站注册需要想国家有关部门申请备案，防止网站从事非法活动，而国外网站不需要备案

3、IP反查：通过目标组织的域名查询IP，然后再通过IP反查域名的方式，查询主机IP是否有其他网站。

##### Whois查询

Whois 是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商、域名注册日期和过期日期等）。

通过域名Whois服务器查询，可以查询域名归属者联系方式，以及注册和到期时间。

实际上就是根据whois查询出得信息去查询哪些域名拥有相同联系人、联系邮箱得信息

###### whois在线查询：

-  站长之家域名WHOIS信息查询地址：http://whois.chinaz.com/
-  爱站网域名WHOIS信息查询地址：https://whois.aizhan.com/
-  中资源域名WHOIS信息查询地址: https://www.zzy.cn/domain/whois.html
-  国外whois信息查询地址：https://who.is/
-  阿里云域名查询：https://whois.aliyun.com/

##### 备案信息查询

ICP备案是指网站在信息产业部提交网站信息进行官方认可。对国内各大小网站(包括企业及个人站点)的严格审查工作，对于没有合法备案的非经营性网站或没有取得ICP许可证的经营性网站， 根据网站性质，将予以罚款，严重的关闭网站，以此规范网络安全，打击一切利用网络资源进行不法活动的犯罪行为。

- 企查查: https://www.qcc.com/

- 天眼查: https://www.tianyancha.com/

- ICP备案查询-站长工具: http://icp.chinaz.com/

- 小蓝本: https://www.xiaolanben.com/pc


天眼查上可以查看公司的知识产权中，查看到网站备案信息、微信公众号都存在资产信息小蓝本查询出来的网站更多，备案的和未备案的都能查到。PS:未备案的域名除非服务器将开放的端口改为了非常用端口才可以访问。

也查询到未备案的域名

通过备案号信息查询

一个备案号可以去换编号去查询，可能存在其他备案信息https://beian.miit.gov.cn/#/Integrated/recordQuery

##### IP反查

渗透测试过程中，批量扫描到一些IP地址，需要反差域名

- 360威胁情报中心:https://ti.360.net/#/homepage
- 微步在线: https://x.threatbook.cn/

- ViewDns: http://viewdns.info/

- 17CE性能检测平台: http://www.17ce.com/

##### 浏览器插件

通过chrome、firefox等浏览器插件的使用，收集域名信息，常见的浏览器插件有

`Myip.ms`、`TCPIPUTILS`、`DNSlytics`、`shodan`、`Fofa`等。

##### VirusTotal

`Virustotal` 是一个有点类似于国内微步在线的平台，但它较于微步好的一点在于它无需等级无需付费也可以获取很多国内平台需要付费的内容

https://www.virustotal.com/

在微步中每月仅允许查询 5 次，每次不超过 1000 条结果，而 vt 这个平台好像没有太大限制，vt是比较收集信息多的，看这图比较麻烦，写了个脚本用于调用 vt 的 api 接口去获取子域名，在调用接口之前，需要去 Virustotal ( https://www.virustotal.com/) 注册个账号，然后将获取到的 apikey 放入脚本中即可使

###### api

```bash
7a5a35308da44bdbe7df0efab54682cbeb0f8f54f290f2fcafcaf6f97a0ab4c1
```

###### vt.py

```python
import re
import sys  
import time
import requests

"""
BY L8_24

Use Virustotal (www.virustotal.com) for search subdomains.
"""

apikey = "7a5a35308da44bdbe7df0efab54682cbeb0f8f54f290f2fcafcaf6f97a0ab4c1"

def getSubdomain(domain, cursor = ""):
    url = f"https://www.virustotal.com/api/v3/domains/{domain}/subdomains? limit=1000&cursor={cursor}"
    headers = {
        "x-apikey": f"{apikey}",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0"
    }
    ans = requests.get(url=url, headers=headers) 
    txt = ans.text
    cursor = getNext(txt) 
    return txt, cursor

def getNext(txt):
    reg = re.compile(r'"cursor": "(.*?)"')
    next = reg.search(txt) 
    if next:
        return next.group(1) 
    else:
        return ""

def getSubdomain(domain, cursor = ""):
    url = f"https://www.virustotal.com/api/v3/domains/{domain}/subdomains? limit=1000&cursor={cursor}"
    headers = {
        "x-apikey": f"{apikey}",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0"
    }
    ans = requests.get(url=url, headers=headers) 
    txt = ans.text
    cursor = getNext(txt) 
    return txt, cursor

def getNext(txt):
    reg = re.compile(r'"cursor": "(.*?)"')
    next = reg.search(txt) 
    if next:
        return next.group(1) 
    else:
        return ""

def downloadSubdomain(domain, fileObj): 
    txt, cursor = getSubdomain(domain)  
    while True:
        fileObj.write(cleanData(txt)) 
        if not cursor:
            break
        txt, cursor = getSubdomain(domain, cursor)

def cleanData(txt):
    reg = re.compile(r'"id": "(.*?)"') 
    res = reg.findall(txt)
    return "\n".join(res)

if  __name__    == "__main__": 
    if len(sys.argv) == 2:
        if apikey == "":
            exit("\n[ERROR] : Missing apikey, Please set config with apikey!!!") 
        filename = f"./res_{int(time.time())}.txt"
        fileObj = open(filename, "a")
        downloadSubdomain(sys.argv[1], fileObj)
        print(f"\n[SUCCESS] : *.{sys.argv[1]} save in {filename} ") 
    else:
        print("""
    Usage: python vt.py domain

    e.g. python vt.py baidu.com 
        """)
```

###### 运行

```python
python vt.py baidu.com
```



#### 子域名收集

子域名收集：假设目标网站的规模比较大，或者直接对站点无法渗透时，可以先进入某个目标的某个子域，然后再迂回真正目标。一台服务器上有很多个站点，这些站点密钥必然联系，是互相独立的，使用不同的域名和端口，但是存在一台服务器上

##### 收集方法

- 枚举--基于字典的枚举是一种查找带有通用名称的子域名的技术

- 搜索引擎--Google hacking，Bing搜索

- 第三方聚会服务--第三方服务聚合了大量的DNS数据集，并通过它们来检索给定域名的子域名

- 其他--证书透明度，DNS域传输，文件泄露等。


##### 枚举：

通过域名枚举工具实现子域名发现的目标，使用工具进行**域名枚举**的关键在于字典是否足够齐全

- `Layer`子域名挖掘机: https://github.com/euphrat1ca/LayerDomainFinder
- `OneForAll`: https://github.com/shmilylty/OneForAll 能解决一部分泛解析问题
- `SubDomainsBrute`: https://github.com/lijiejie/subDomainsBrute 能解析泛解析的问题

###### 子域名泛解析的成因

在子域名解析中，每个子域名都会解析为一个特定的IP地址。只有被设置解析，用户才能正常进行访问。

一旦用户输入错误的子域名，就会造成无法访问。

在网站运营中，域名持有者为了避免因为错误输入，而造成用户流失，就会使用泛域名解析。

泛域名解析是一种特殊的域名解析方式。它使用通配符形式，设置域名解析。

它可以将没有明确设置的子域名一律解析到一个IP地址上。这样，即使用户输入错误的子域名，也可以访问到域名持有者指定的IP地址。

但是信息收集中，这会造成请求的所有子域名都能访问的假象，从而收集到一堆无效的子域名。

1. 支持无限子域名，无需为每个子域名单独配置DNS记录。
2. 防止用户错误输入，即使输入错误的子域名也能访问正确的网站。
3. 简洁的网址访问，直接输入子域名即可访问网站

###### 缺点：

1. 恶意泛解析可能导致搜索引擎对网站的评价降低，从而影响网站的权重和流量。 这可能导致网站在搜索引擎结果中的 排名下降 ，甚至被完全排除在搜索结果之外。
2. 恶意信息被收录 ：当域名被恶意泛解析时，可能会出现大量垃圾和违规信息。

###### 泛域名解析举例

域名解析是：子域名.域名解析到同一IP。

泛域名解析是：`*.域名`解析到同一IP。

- ping wwwwwwwwww.baidu.com
- ping wwwwwwwwww.taobao.com

当域名无法被解析时，则代表该网站没有使用泛解析。

###### layer子域名挖掘机：

Layer子域名挖掘机用于网站子域名查询，有服务接口、暴力破解、同服挖掘三种模式，使用说明：

1. 1、如果要使用自定义字典，请把字典文件命名为dic，放到跟程序同目录下，程序会自动加载字典。
2. 2、如果没有自定义字典，程序会自动使用内置字典，内置字典总共两万多条数据，内容包括了常用子域名，以及3000+常用单词和1-3位所有字母。
3. 3、如果要爆破二级以下域名，可以直接填入要爆破的子域名，程序会自动拼接下一级子域。比如填入hi.baidu.com，程序会爆破hi.baidu.com下面的域。
4. 4、如果界面列表显示有空白，请右键选择“导出域名和IP”来导出完整列表。

###### Oneforall

```bash
git clone https://github.com/shmilylty/OneForAll
cd OneForAll
pip3 install -r requirements.txt --ignore-installed

pip uninstall exrex
pip install exrex

vim /usr/local/lib/python3.11/dist-packages/exrex.py
#from re import sre_parse, U
import sre_parse
from re import U

python3 oneforall.py --target baidu.com run 
```

添加 API 

```python
# 模块API配置
# Censys可以免费注册获取API：https://censys.io/api
censys_api_id = 'd49a1245-8ac2-41b3-a7f6-18c6d1abccab'
censys_api_secret = 'OF14vPJ8bgQqKJRxRueK1Vbr7IkTSLJx'

# Binaryedge可以免费注册获取API：https://app.binaryedge.io/account/api
# 免费的API有效期只有1个月，到期之后可以再次生成，每月可以查询250次。
binaryedge_api = 'acbcb8a6-1f29-4ea3-9136-d228ec14a4dc'

# BeVigil API: https://bevigil.com/osint-api
bevigil_api = '9N8z1pB4iVQPrNQx'

# Chinaz可以免费注册获取API：http://api.chinaz.com/ApiDetails/Alexa
chinaz_api = ''

# Bing可以免费注册获取API：https://azure.microsoft.com/zh-cn/services/
# cognitive-services/bing-web-search-api/#web-json
bing_api_id = ''
bing_api_key = ''

# SecurityTrails可以免费注册获取API：https://securitytrails.com/corp/api
securitytrails_api = 'dtWs9gYNI2FljR_p48raBgmQKWSf1kYP'

# https://fofa.so/api
fofa_api_email = '1745272762@qq.com'  # fofa用户邮箱
fofa_api_key = '0b86c3f885b8c095462ce6d58a99d9aa'  # fofa用户key

# Google可以免费注册获取API:
# 免费的API只能查询前100条结果
# https://developers.google.com/custom-search/v1/overview#search_engine_id
# 创建自定义搜索引擎后需要在响应的控制面板上启用Search the entire web
google_api_id = ''  # Google API自定义搜索引擎id
# https://developers.google.com/custom-search/v1/overview#api_key
google_api_key = ''  # Google API自定义搜索key

# https://api.passivetotal.org/api/docs/
riskiq_api_username = ''
riskiq_api_key = ''

# Shodan可以免费注册获取API: https://account.shodan.io/register
# 免费的API限速1秒查询1次
shodan_api_key = '3n7iCIbg9Xv0jwQf8ZalcocJFcLTchh3'
# ThreatBook API 查询子域名需要收费 https://x.threatbook.cn/nodev4/vb4/myAPI
threatbook_api_key = ''

# VirusTotal可以免费注册获取API: https://developers.virustotal.com/reference
virustotal_api_key = '7a5a35308da44bdbe7df0efab54682cbeb0f8f54f290f2fcafcaf6f97a0ab4c1'

# https://www.zoomeye.org/doc?channel=api
zoomeye_api_key = 'FC29B28C-60B8-5943C-59F8-7DE482dC2c7'

# Spyse可以免费注册获取API: https://spyse.com/
spyse_api_token = ''

# https://www.circl.lu/services/passive-dns/
circl_api_username = ''
circl_api_password = ''

# https://www.dnsdb.info/
dnsdb_api_key = ''

# ipv4info可以免费注册获取API: http://ipv4info.com/tools/api/
# 免费的API有效期只有2天，到期之后可以再次生成，每天可以查询50次。
ipv4info_api_key = ''

# https://github.com/360netlab/flint
# passivedns_api_addr默认空使用http://api.passivedns.cn
# passivedns_api_token可为空
passivedns_api_addr = ''
passivedns_api_token = ''

# Github Token可以访问https://github.com/settings/tokens生成,user为Github用户名
# 用于子域接管和子域收集
github_api_user = ''
github_api_token = ''

# obtain Cloudflare API key from https://dash.cloudflare.com/profile/api-tokens
cloudflare_api_token = ''

# https://hunter.qianxin.com/home/userInfo
hunter_api_key = 'f86440c39a9ff3decde183f59d9198d128f36be26f7331f3186f0612c74d15a4'

# https://api-docs.fullhunt.io/
fullhunt_api_key = ''


# 登录quake之后可在个人中心获取key https://quake.360.net/quake/#/personal?tab=message
quake_api_key = 'e2f2ea84-8d51-4990-984a-57f9d214c754'

#https://www.racent.com/ctlog F2>Network抓包获取Token
racent_api_token = ''
```



https://github.com/shmilylty/OneForAll

https://blog.csdn.net/qq_15042405/article/details/121680860

https://www.cnblogs.com/mightnire/p/17609329.html

```bash
--alive=True
			可选值True，False分别表示导出存活，全部子域结果
--dns=DNS
			DNS解析子域(默认True)
--req=REQ
			HTTP请求子域(默认True)
--port=PORT
			请求验证子域的端口范围(默认只探测80端口)
--fmt=FMT
			结果保存格式(默认csv)
--path=PATH
			结果保存路径(默认None)
--takeover=TAKEOVER
			检查子域接管(默认False)
```



docker安装

```
docker pull shmilylty/oneforall
docker run -it --rm -v ~/results:/OneForAll/results -v ~/.config:/OneForAll/config shmilylty/oneforall --target example.com run
```

###### httpx

```
https://github.com/encode/httpx

pip install httpx
```

###### nuclei-templates

https://github.com/projectdiscovery/nuclei

https://github.com/projectdiscovery/nuclei-templates

```
git clone https://github.com/projectdiscovery/nuclei-templates
wget https://github.com/projectdiscovery/nuclei/releases/download/v3.3.2/nuclei_3.3.2_linux_amd64.zip
unzip nuclei_3.3.2_linux_amd64.zip -d nuclei/
cd nuclei
./nuclei -h
```

###### snap

```
git clone https://github.com/snap-stanford/snap.git
cd snap
make all
cd doxygen; make all
cd ..
cd tutorials; make all
cd ..
cd test; make run
```

###### subfinder

https://github.com/projectdiscovery/subfinder.git

```
wget https://github.com/projectdiscovery/subfinder/releases/download/v2.6.6/subfinder_2.6.6_linux_amd64.zip
unzip subfinder_2.6.6_linux_amd64.zip -d subfinder
rm -f subfinder_2.6.6_linux_amd64.zip
cd subfinder
./subfinder -h

./subfinder -d baidu.com -v
```



```
vim /root/.config/subfinder/provider-config.yaml

bevigil: []
binaryedge: []
bufferover: []
builtwith: []
c99: []
censys: []
certspotter: []
chaos: []
chinaz: []
dnsdb: []
dnsrepo: []
facebook: []
fofa: 
  - fofa.info:0b86c3f885b8c095462ce6d58a99d9aa
fullhunt: []
github: []
hunter: 
  - f86440c39a9ff3decde183f59d9198d128f36be26f7331f3186f0612c74d15a4
intelx: []
leakix: []
netlas: []
passivetotal: []
quake: 
  - e2f2ea84-8d51-4990-984a-57f9d214c754
redhuntlabs: []
robtex: []
securitytrails: []
shodan: 
  - 3n7iCIbg9Xv0jwQf8ZalcocJFcLTchh3
threatbook: []
virustotal: 
  - 7a5a35308da44bdbe7df0efab54682cbeb0f8f54f290f2fcafcaf6f97a0ab4c1
whoisxmlapi: []
zoomeyeapi: 
  - zoomeye.hk:FC29B28C-60B8-5943C-59F8-7DE482dC2c7
```



###### subDomainsBrute

```bash
//参数介绍：
--version //显示程序的版本号并退出
-h, --help //显示此帮助信息并退出
-f FILE //文件包含新行分隔的子文件，默认为子域名称.txt。
--full //全扫描，将使用NAMES FILE subnames_full.txt 野蛮
-i, --ignore-intranet //忽略指向私有 IP 的域
-w, --wildcard //通配符测试失败后强制扫描
-t 线程，--threads=线程
//扫描线程数，默认256
-p 进程, --process=进程
//扫描进程数，默认为6
-o 输出, --output=OUTPUT
//输出文件名。 默认为 {target}.txt
```

```bash
python3 subDomainsBrute.py baidu.com --full -i -t 30 -o baidu.txt
//结果将输出到 "tmp/(域名_时间)/baidu.txt" 文件内
```

![image-20240822103642048](../../../../repo/assets/24_2.信息收集/image-20240822103642048.png)

![image-20240822103707776](../../../../repo/assets/24_2.信息收集/image-20240822103707776.png)

##### 搜索引擎查询：

原理：通过搜索引擎获取已经爬取的子域名；

###### theHarvester（kali自带）

```
-d：搜索的域或公司名称
-b：数据来源（google、bing、bingapi、pgp、linkedin、google-profiles、baidu、jigsaw、all）
-s：结果编号从X开始（默认为0）
-v：通过dns解析验证主机名，并搜索虚拟主机
-f：将结果保存到HTML和XML文件中
-n：对所有发现的地址范围进行DNS反向查询
-c：对域名执行DNS强力解析
-t：执行DNS TLD扩展发现
-e：指定DNS服务器
-l：限制结果数量（pgp不使用此选项）
-h：使用SHODAN数据库查询已发现的主机
```

```
//例子：
theHarvester -d microsoft.com -l 500 -b google
theHarvester -d microsoft.com -b all
theHarvester -d microsoft -l 200 -b linkedin
```

###### 在线查询工具：

http://tool.chinaz.com/subdomain/

https://x.threatbook.cn/

https://www.dnsgrep.cn/subdomain

http://z.zcjun.com/

##### 第三方聚合服务

- 第三方：利用第三方网站和一些博主提供服务进行子域名发现

- 权重综合查询：利用权重综合查询进行子域名发现

- 全国政法网站基本数据库：针对特定性质网站可通过全国政法网站基本数据库进行子域名发现


###### 第三方平台：

- https://hackertarget.com/find-dns-host-records/

- https://dnsdumpster.com/


###### 权重综合查询：

- 爱站：https://www.aizhan.com/cha/

- 站长工具：https://rank.chinaz.com/all/

- 全国政法网站基本数据库: https://zfwzzc.www.gov.cn/


##### 提取SSL证书里的域名:

我们学过http和https了，很清楚的知道，如果我们是一个公司，做了一个网站，想要使用https协议来传输数据，那么我们需要注册和安装ssl证书，所以我们可以通过ssl证书的查询，也能获取一些信息

###### 证书透明度公开日志枚举

证书透明度[Cerikeate Transparene,CT)是证书授权机构[CA)的一个项目。证书授权机构会将每个5SLTLS证书发布野公共日志中。

一个证书通常包含域名、子域名和部件地址。这些也经常成为红队评估非常希望快得的有用信息。

查找某个城名所属证书的最简单的方法就是使用一些公开的CT日志

https://crt.sh/

###### 证书透明度公开日志枚举(工具查询)

通过利用工具调用各个证书接口进行域名查询。

`Findomain`: https://github.com/Findomain/Findomain

Findomain不使用子域名寻找的常规方法，而是使用证书透明度日志来查找子域，并且该方法使其工具

更加快速和可靠。该工具使用多个公共API来执行搜索：

子域名收集：

```
findomain -t target.com
```

linux

```bash
wget https://github.com/Findomain/Findomain/releases/download/9.0.4/findomain-linux.zip
unzip findomain-linux.zip
cd findomain-linux
chmod +x findomain-linux

./findomain-linux -t baidu.com -o baidu.txt
```

windows

```
https://github.com/Findomain/Findomain/releases/download/9.0.4/findomain-windows.exe.zip
findomain -t baidu.com -o baidu.txt
```



##### 大厂商SSL证书一证多用

大厂商的SSL证书一般都是一证多用，根据证书透明日志这个特性，可以得知一些子域名。

如百度：https://www.baidu.com

##### 方法

用DNS数据集收集子域

利用DNS记录公开数据收集 ；

###### 检测方法：

注：将需要{domain}换成需要查询的域名，加粗的是我认为效果较好;

- `ip138`：https://site.ip138.com/{domain}/domain.htm
- `hackertarget`：https://hackertarget.com/find-dns-host-records/
- `netcraft`：https://searchdns.netcraft.com/

###### 文件泄露：

网站根目录下的`crossdomain.xml` 文件指明了远程Flash是否可以加载当前网站的资源（图片，网页内容，Flash）有时候可以用了收集到一些与目标组织域名相关的信息

#### 真实IP收集

CDN全称是Content Delivery Network，即内容分发网络。其原理如下：某些大型网站在全国都会有很多用户，这些用户常常会向网站发送不同的请求，那么不同地域会具有不同的缓冲服务器来接收用户发送的流量。

如果用户发送流量没有任何交互的数据，只是请求首页的话，此时根据用户所在地区来确定访问的高速缓存服务器，高速缓存服务器会返回对应的响应到用户的浏览器当中，比如广东。

CDN的优势：隐藏源主机IP，降低延迟，提高服务响应速度，增加网络冗余，减小主机服务器压力。

只有当用户填写数据，需要交互时才会将请求发送到真实的服务器；此时通过广东省的缓存服务器来连接真实服务器。

CDN通常存在用户很多的大型流量网站，通过它来解决服务器的瓶颈。

##### 域名解析过程：

- 传统访问：用户访问域名-->解析ip-->目标主机
- 简单模式：用户访问域名-->CDN节点-->真实IP-->目标主机
- 360网站卫士：用户访问域名-->CDN节点（云WAF）-->真实IP-->目标主机

##### 验证目标是否存在挂载CDN：

- 多地ping，查看IP是否一样；
- 站长工具：https://ping.chinaz.com/
- 17CE: https://wwww.17ce.com/
- IPIP: https://tools.ipip.net/
- 国内在线CDN云观测:http://cdn.chinaz.com

##### CDN 判断

在线IP查询

http://tool.chinaz.com/nslookup

##### CDN绕过

- 内部邮箱源：收集到内部邮箱服务器IP地址

- 网站phpinfo文件：phpinfo.php

- 分站IP地址，查询子域名：CDN很贵，很有可能分站就不再使用CDN国外访问：https://ranking.fenban.net/Ping/cn/

- 查询域名解析记录：https://www.ip138.com/

通过上面的方法获取了很多的IP地址，此时利用IP地址对Web站点进行访问，如果正常则说明是真实IP，否则为假。

###### 邮件RSS邮件阅

在web服务器和email服务器在一起时可以通过email也获取真实IP，如果不属于同一台服务器时获取的IP可能只是email服务器的地址，常见发生邮件的功能有：注册用户、找回密码等。

注册的时候会发送邮件，然后查看邮件全文源代码或邮件标头。

###### 网站根域或者子域找真实IP

一般情况下，CDN服务器是按照流量收费的，管理员可能给一些主要业务的网站部署CDN，根

域或者子域业务可能没有部署CDN，这种情况下可以收集其子域名来尝试获取真实ip地址。

###### 域名历史解析录找真实IP

查询目标域名历史解析录可能会找到部署CDN前的解析记录（真实IP地址）

- 微步在线：https://x.threatbook.cn
- 历史查询：https://viewdns.info/iphistory/
- 国外查询：https://securitytrails.com/#search
- 国外查询：https://sitereport.netcraft.com/
- 国外查询：https://webiplookup.com/

###### 探针找到真实IP

php、phpinfo.php等探针类文件极可得到真实ip地址 phpinfo.php 搜索SERVER_NAME。

###### 网络空间引擎搜索法

常见的`shodan，fofa，ZoomEye`搜索。以fofa为例，只需输入：h`ost=”shouhuola.com“`就可以找出fofa收录的有这些关键字的ip域名，或者搜索网站源代码中的title内容得到真实IP地址，title="xxxx"，有时能获取网站的真实ip。

搜索抽屉新热榜的真实IP地址，网址是 https://dig.chouti.com/ ，我们通过自己个人常用 的浏览器，比如chrome浏览器来打开这个网站。

我们看到这个title标签中的内容是 抽屉新热榜-聚合每日热门、搞笑、有趣资讯，把这几个文字拿到佛法(FOFA)中去搜索

###### 使用国外主机请求域名

部分国内的cdn加速服务商只对国内的线路做了CDN加速，但是国外的线路没有做加速，这样就可以通过国外的主机来探测真实的IP信息。

探测的方式也有两种，可以利用已有的国外主机直接进行探测；如果没有国外主机，可以利用公开的多地ping服务（多地ping服务有国外的探测节点），可以利用国外的探测节点返回的信息来判断真实的IP信息。

###### SSL证书找到真实IP

1、Censys查询

利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在https://crt.sh上查找目标网站SSL证书的HASH，然后再用Censys搜索该HASH即可得到真实IP地址。

第一步：查看网站的SSL证书,获取指纹

第二步：使用https://crt.sh/查询

第三步：在网站https://censys.io/上用SHA-256的值查询

### 2-2 Github监控

#### exp监控

##### github-cve-monitor

工具地址：https://github.com/yhy0/github-cve-monitor

https://blog.csdn.net/qq_36584013/article/details/123650853

##### CVEAP

工具地址：https://github.com/JustYoomoon/CVEAP

#### 钉钉机器人

步骤一：在海外云主机上运行一下命令拉取项目文件

```BASH
git clone https://github.com/JustYoomoon/CVEAP.git
cd CVEAP
vim cveap.py
```



```BASH
##########修改处1########
# 钉钉
def dingding(text, msg):
    # 将此处换为钉钉机器人的api
    webhook = 'https://oapi.dingtalk.com/robot/send?access_token=43e4ea4d4b4be565763d4ef93de270549e894190eef8a9f558bc55007f7c29fb'
    ding = cb.DingtalkChatbot(webhook, secret="SEC164882fd5f9948e7fddb1f5975de7b6ce4b593e117ae313c35d5c207a8f58d8c")
    ding.send_text(msg='{}\r\n{}'.format(text, msg), is_at_all=False)
    
##########修改处2########
# 三选一即可，没配置的 注释或者删掉
# server(text, msg)
dingding(text, msg)
# tgbot(text,msg)
# print(msg)
# mail(text, msg)
```

步骤三：在钉钉中新建群并开启群机器人，将一下信息复制并填写到上面要修改的信息

步骤四：在服务器上安装上要安装的第三方库 `requests`,`dingtalkchatbot`

```python
pip3 install requests
pip3 install dingtalkchatbot
```



```python
tee requirements.txt <<-'EOF'
requests
dingtalkchatbot
EOF

pip install -r requirements.txt
```



```BASH
screen -S CVEAP
python3 cveap.py
ctrl+a ctrl+d
```

### 2-3 资产收集

#### 灯塔系统-ARL

旨在快速侦察与目标关联的互联网资产，构建基础资产信息库。 协助甲方安全团队或者渗透测试人员有效侦察和检索资产，发现存在的薄弱点和攻击面。

##### 下载：

https://github.com/Aabyss-Team/ARL?tab=readme-ov-file

```BASH
wget https://raw.githubusercontent.com/Aabyss-Team/ARL/master/misc/setup-arl.sh
chmod +x setup-arl.sh
./setup-arl.sh
```

> ARL-Web页面：https://192.168.70.4:5003/
>
> 账号：admin
>
> 密码：honmashironeko

##### 添加指纹 

https://github.com/loecho-sec/ARL-Finger-ADD

```BASH
git clone https://github.com/loecho-sec/ARL-Finger-ADD
cd ARL-Finger-ADD
python ARL-Finger-ADD.py https://192.168.70.4:5003/ admin honmashironeko
```

##### 代理

```
第一步：创建配置文件
sudo mkdir -p /etc/systemd/system/docker.service.d
sudo vim /etc/systemd/system/docker.service.d/http-proxy.conf

第二步：在文件中添加代理
[Service]
Environment="HTTP_PROXY=socks5:/192.168.70.1:7890"
Environment="HTTPS_PROXY=socks5://192.168.70.1:7890"

第三步：重启Docker
sudo systemctl daemon-reload
sudo systemctl restart docker

第四步：查看环境变量
sudo systemctl show --property=Environment docker
```

https://www.ddosi.org/arl/

https://www.cnblogs.com/tanyiqu/p/17975726

https://blog.csdn.net/just_for_that_moment/article/details/125308103

#### Firefly

`Firefly`是一个集资产管理、信息收集和漏洞扫描的综合平台。

`Firefly-SRC`依托于Firefly平台中的信息收集功能，不断收集和整理各大src相关资产数据

> 目前平台已收录SRC厂商200+，主要是国内企业自建src或补天等平台的专属src。
>
> 基本可维持子域名更新周期在7天左右，网站信息收集周期约10天左右。
>
> 共收集域名资产200多万条，网站资产50多万条。

平台访问地址：http://firefly.geekyoung.com/#/

```bash
https://firefly-src.geekyoung.com/#/dashboard/analysis
so0izjydjcey7xq2wvaed8uyu7y2259h
```

#### 七麦数据（app）

 https://www.qimai.cn/

#### 阿拉丁

https://www.aldzs.com

### 2-4 网站敏感信息

#### 指纹探测

指纹识别常见检测对象：

1. （1）**CMS** <内容管理系统>信息，常见CMS: `dede织梦、wordpress、phpcms、ezcms、ecshop、帝国、大汉cms`
2. （2）**前端技术**：`html5、jquery，bootstarp，pure，ace，ajax`等等
3. （3）**中间件和容器等**：`apache，iis，nginx，lighttpd，tomcat，weblogic，jboss，websphere`等
4. （4）**开发语言**:`php java ruby go python c# Jsp asp aspx`等等
5. （5）**操作系统**: `Windows NT、类UNIX (MACOS)`
6. （6）**CDN信息**:是否使用CDN技术、常用CDN: `cloudflare/36OCDN/365cyd`等等
7. （7）**端口或者服务**:
8. （8）**IP或者域名信息**;
9. （9）**WAF**:检测是否有WAF:云盾、云锁、安全狗、IPS/IDS、等等

#### CMS指纹信息

CMS（内容管理系统）又称为整站系统或文章系统，用于网站内容管理。用户只需要下载对应的CMS软件包，就能部署搭建，并直接利用CMS。

但是各种CMS都具有其独特的结构命名规则和特定的文件内容，因此可以利用这些内容来获取CMS站点的具体软件CMS与版本。

常见的CMS包括Discuz、Dedecms（织梦）、PhpCMS、WordPress、74cms等，通过网站使用的CMS找取该CMS已经公布的漏洞进行利用，进一步渗透网站。

CMS(Content ManagementSystem)内容管理系统，CMS系统是网站建设走向成功的重要组成部分，国内外的CMS种类比较多，下面介绍常用的CMS。

##### 常用的CMS

1. **企业建站系统**:MetInfo(米拓)、蝉知、SiteServer CMS(.net平台)等;
2. **B2C商城系统**:商派shopex、ecshop、hishop、xpshop等;
3. **门户建站系统**:DedeCMS(织梦，PHP+MYSQL)、帝国CMS(PHP+mysqI)、PHPCMS、动易cmstop，dianCMs(易点CMS，.net平台)等;
4. **博客系统**:wordpress、Z-Blog、typecho等;:
5. **论坛社区**:discuz、phpwind、wecenter等;
6. **问答系统**:Tipask、whatsns等;
7. **知识百科系统**:HDwiki;
8. **B2B门户系统**:destoon、B2Bbuilder、友邻B2B等
9. **人才招聘网站系统**:骑士74CMS、PHP云人才管理系统;
10. **房产网站系统**:FangCms等;
11. **在线教育建站系统**:kesion(科汛，ASP)、EduSoho网校;
12. **电影网站系统**:苹果cms、ctcms、movcms等;
13. **小说文学建站系统**:JIEQICMS;基于thinkphp二次开发的CMS

##### 1、特定文件的MD5

一些网站的特定图片文件、js文件、CSS等静态文件，如`favicon.ico、css、logo.ico、js`等文件一般不会修改，通过爬虫对这些文件进行爬取并比对md5值，如果和规则库中的md5一致说明是同一CMS，但也不排除有些二次开发的CMS会修改这些文件。

##### 2、正常页面或错误网页中包含的关键字

先访问首页或特定页面如 robots.txt 等，通过正则的方式区匹配某些关键字，如`powered by Discuz`、`dedecms`等或者构建错误页面，根据错误信息来判断使用CMS或者中间件信息，比较常见如 tomcat 的报错页面

##### 3、请求头信息的关键字匹配

根据网站response返回头信息进行关键字匹配, `whatweb`和`wappalyzer`是通过banner信息来快速识别指纹。

之前向fofa的web指纹库很多都是使用的这种方法，效率非常高，基本请求一次就可以。

但搜索这些规则可能耗时长， 而且这些banner信息有些很容易被改掉。

###### 根据`response header`—般有以下几种识别方式:

1. 查看http响应报头的`X-Powered-By`字段来识别;
2. 根据`Cookies`来进行判断，比如一些waf会在返回头中包含一些信息，如`360wzws、Safedog、yunsuo`等;
3. 根据header中的`Server`信息来判断，如`DVRDvS-Webs、yunjiasu-nginx、Mod_Security、nginx wallarm`等;
4. 根据`WWW-Authenticate`进行判断，一些路由交换设备可能存在这个字段，如`NETCORE、huawej、h3c`等设备。

##### 4、部分URL中包含的关键字，比如 wp-includes. dede等URL关键特征

通过规则库去探测是否有相同目录，或者根据爬虫结果对链接url进行分析，或者对`robots.txt`文件中目录检测等等方式，通过url地地址判别是否使用了某CMS，比如`wordpress`默认存在 `wp-includes`和`wp-admin`目录，**织梦**默认管理后台为`dede`目录，`solr`平台可能使用`/solr`目录,`weblogic`可能使用`wls-wsat`目录等。

##### 5、开发语言的识别

web开发语言一般常见的有PHP、 jsp、aspx、asp等，

常见的识别方式有:

###### 1）通过×-Powered-By进行识别

比较常见的有`x-Powered-By`: `ASP.NET`或者`X-Powered-By:PHP/7.1.8`

###### 2）通过Set-Cookie进行识别

这种方法比较常见也很快捷，比如`Set-Cookie`中包含`PHPSSIONID`说明是`php`、包含`JSESSIONID`说明是`java`、包含`ASP.NET_Sessionld`说明是`aspx`等。

##### 在线识别工具

通过第三方在线平台进行指纹识别

- 云悉：https://www.yunsee.cn/

- 潮汐：http://finger.tidesec.net/

- 360Finger https://fp.shuziguanxing.com/#/

##### 本地识别工具

通过利用**指纹识别**工具进行指纹识别

- **whatWeb**: https://github.com/urbanadventurer/WhatWeb kali自带
- **御剑web指纹识别程序**: https://www.webshell.cc/4697.html
- **w11scan分布式WEB指纹识别平台**: https://github.com/w-digital-scanner/w11scan
- **Dayu指纹识别工具**:https://github.com/Ms0x0/Dayu
- **EHole指纹探测工具**：https://github.com/EdgeSecurityTeam/EHole

##### EHole

地址：https://github.com/EdgeSecurityTeam/EHole

```bash
wget https://github.com/EdgeSecurityTeam/EHole/releases/download/v3.1/EHole_linux_amd64.zip
unzip EHole_linux_amd64.zip -d EHole/
cd EHole/EHole_linux_amd64

vim config.ini

Email=1745272762@qq.com
Fofa_token=0b86c3f885b8c095462ce6d58a99d9aa
Fofa_timeout=10

EHole_linux_amd64 -h
```



```bash
EHole version: 2.0
Usage: Ehole [-f|-l] [parameter]

Options:
  -f string
        Fofa searches for assets , supports IP and IP segments。(192.168.1.1 | 192.168.1.0/24)
  -ftime string
        fofa timeout (default "10")
  -h    this help
  -json string
        out json
  -l string
        Probe based on local file
  -log string
        Log file name (default "server.log")
  -t string
        thread (default "100")
```

###### 本地识别：

//URL地址需带上协议，每行一个

```bash
EHole_linux_amd64 -l url.txt 
```

###### FOFA识别：

//支持单IP或IP段

注意：从 FOFA 识别需要配置 FOFA 密码以及邮箱，在 config.ini 内配置好密码以及邮箱使用。

```bash
EHole_linux_amd64 finger -f 192.168.3.1/24 
```

###### 结果输出：

//结果输出至export.json文件

```bash
EHole -l url.txt -json export.json 
```



##### whatcms

https://whatcms.org/

##### wahtweb

kali自带

```bash
whatweb baidu.com
```



##### TideFinger

https://github.com/TideSec/TideFinger_Go

http://www.tidesec.net/

```bash
wget https://github.com/TideSec/TideFinger_Go/releases/download/v2.3/TideFinger_Linux
chmod +x TideFinger_Linux
./TideFinger_Linux -h
```



```bash
TideFinger -h 192.0.0.1/24 -p 80 -np -nobr -nopoc       探测C段开放80端口的服务指纹，不使用ping，不暴力破解，不检测poc
TideFinger -u http://www.tidesec.com -pd                探测指定url的指纹，检测poc，并显示poc的详细数据
TideFinger -uf url.txt -nobr -nopoc -pt 120 		   探测指定url文件的指纹，每个服务指纹超时为120秒

flag needs an argument: -h
Usage of ./TideFinger_Linux:
  -br int
        Brute threads (default 1)
  -cookie string
        set poc cookie
  -h string
        IP address of the host you want to scan,for example: 192.168.11.11 | 192.168.11.11-255 | 192.168.11.11,192.168.11.12
  -hf string
        host file, -hf ip.txt
  -level int
        Specify log level (0:Fatal 1:Error 2:Info 3:Warning 4:Debug 5:Verbose) (default 3)
  -m string
        Select scan type ,as: -m ssh (default "all")
  -nobr
        not to Brute password
  -nopoc
        not to scan web vul
  -np
        not to ping
  -num int
        poc rate (default 20)
  -o string
        Outputfile (default "result.txt")
  -oa string
        OutForTideai
  -p string
        Select a port,for example: 22 | 1-65535 | 22,80,3306 (default "21,22,80,81,135,139,443,445,1433,1521,3306,3389,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017")
  -pd
        Dispaly Poc Data
  -ping
        using ping replace icmp
  -pn string
        the ports no scan,as: -pn 445
  -pocf string
        poc file
  -poclevel string
        select the pocscan level (default "1+2+3")
  -poclist
        print all poc list
  -pocname string
        use the pocs these contain pocname, -pocname weblogic
  -pocpath string
        poc file path
  -portf string
        Port File
  -proxy string
        set poc proxy, -proxy http://127.0.0.1:8080
  -pt int
        Set HostProbe detect timeout (default 90)
  -pwd string
        password
  -pwda string
        add a password base DefaultPasses,-pwda password
  -pwdf string
        password file
  -pwt int
        Set poc_all timeout (default 180)
  -silent
        silent scan
  -socks5 string
        set socks5 proxy, will be used in tcp connection, timeout setting will not work
  -t int
        Thread nums (default 2000)
  -time int
        Set port connect timeout (default 3)
  -top int
        show live len top (default 10)
  -tscan
        use tscan mode
  -u string
        url
  -uf string
        urlfile
  -user string
        username
  -usera string
        add a user base DefaultUsers,-usera user
  -userf string
        username file
  -webproxy string
        Use proxy web scan, support http/socks5 protocol [e.g. -webproxy socks5://127.0.0.1:1080]
  -wt int
        Set poc_web timeout (default 5)
```



##### P1finger64

github：https://github.com/P001water/P1finger

下载链接：https://github.com/P001water/P1finger/releases/download/P1finger_beta/P1finger64.exe

```bash
wget https://github.com/P001water/P1finger/releases/download/P1finger_beta/P1finger64
cd P1finger64
chmod +x P1finger64
./P1finger64 -u baidu.com
```



```bash
#./P1finger64 -h      
红队行动下的重点资产指纹识别工具, Powered by P001water
Usage:
  ./P1finger64 [flags]

Flags:
INPUT:
   -u string   traget url
   -uf string  urls in file

PROXY:
   -socks string      socks proxy
   -httpproxy string  http proxy
```



##### chrome插件

- wappalyzer：https://www.wappalyzer.com
- whatruns：https://www.whatruns.com/

#### 信息泄露

##### 遗留文件 

通过遗留文件获得，比如：

-  phpinfo.php
- info.php
- site.php
- 1.php
- a.php

##### 探针文件

一些探针文件啊都有，等等；

在遗留文件中搜索 `SCRIPT_FILENAME`；很多网站的根目录下都存在测试文件，脚本代码通常都是`phpinfo()`；如：

-  test.php
-  ceshi.php
-  info.php
-  phpinfo.php
-  php_info.php
-  1.php

##### phpmyadmin爆路径：

一旦找到`phpmyadmin`的管理页面，再访问该目录下的某些特定文件，就很有可能爆出物理路径；

至于`phpmyadmin`的地址可以用`wwwscan`这类的工具去扫，也可以选择google；

常见路径：

```js
/phpmyadmin/libraries/lect_lang.lib.php
/phpMyAdmin/index.php?lang[]=1
/phpMyAdmin/phpinfo.php load_file()
/phpmyadmin/themes/darkblue_orange/layout.inc.php
/phpmyadmin/libraries/select_lang.lib.php
/phpmyadmin/libraries/lect_lang.lib.php
/phpmyadmin/libraries/mcrypt.lib.php
```



##### 配置文件找路径

如果注入点有文件读取权限，就可以手工load_file或工具读取配置文件，再从中寻找路径信息（一般在文件

末尾），各平台下Web服务器和PHP的配置文件默认路径可以上网查；

常见配置文件：

```
c:\windows\php.ini php	配置文件
c:\windows\system32\inetsrv\MetaBase.xml  IIS虚拟主机配置文件
C:\xampp\apache\conf\httpd.conf
/var/www/conf/httpd.conf
```

常见集成环境默认目录，后面往往还有以域名命名的目录：

```
C:\Inetpub\wwwroot
C:\xampp\htdocs
D: \phpStudy\WWW
/home/wwwroot/ /www/users/
```

#### 源码泄露信息

- Web源码泄露的漏洞：
- git源码泄露
- svn源码泄露
- hg源码泄漏
- 网站备份压缩文件
- WEB-INF/web.xml 泄露
- DS_Store 文件泄露
- SWP 文件泄露
- CVS泄露
- Bzr泄露
- GitHub源码泄漏

##### git 源码泄露

```
inurl="git"
```

Git是一个开源的分布式版本控制系统，在执行git init初始化目录的时候，会在当前目录下自动创建一个`.git`目录，用来记录代码的变更记录等。发布代码的时候，如果没有把.git这个目录删除，就直接发布到了服务器上，攻击者就可以通过它来恢复源代码;

- HEAD：这个git项目当前处在哪个分支里；
- config：文件包含项目特有的配置选项，git config命令会改动它；
- description：项目的描述信息
- hooks/：系统默认钩子脚本目录
- info/：目录包含一个全局性排除（global exclude）文件，用以放置不希望被记录在 .gitignore 文件中的忽略模式（ignored patterns）
- objects/：目录存储所有数据内容 (commits, trees, blobs, tags)
- refs/：标识你项目里的每个分支指向了哪个提交(commit)。
- index: 文件保存暂存区信息

需要注意的就是HEAD、index、objects、refes这四个条目，在发布代码时若果没有把.git目录删除，直接发布到了运行目录。攻击者就可以通过这个文件夹，用来获取源代码



###### GitHack

地址：https://github.com/lijiejie/GitHack

```bash
git clone https://github.com/lijiejie/GitHack.git
cd GitHack
python3 GitHack.py http://www.openssl.org/.git/
```

修复建议：删除.git目录或者修改中间件配置进行对.git隐藏文件夹的访问；

###### 练习：攻防世界-web-mfw

![image-20240826192101654](../../../../repo/assets/24_2.信息收集/image-20240826192101654.png)

![image-20240826192233774](../../../../repo/assets/24_2.信息收集/image-20240826192233774.png)

![image-20240826192306041](../../../../repo/assets/24_2.信息收集/image-20240826192306041.png)

```
python3 GitHack.py http://61.147.171.105:51022/.git/
```

![image-20240826192446972](../../../../repo/assets/24_2.信息收集/image-20240826192446972.png)

![image-20240826192909366](../../../../repo/assets/24_2.信息收集/image-20240826192909366.png)

##### SVN 源码泄露

```
inurl="svn"
```



SVN是一个开放源代码的版本控制系统。在使用SVN管理本地代码过程中，会自动生成一个名为.svn的隐藏文件夹，其中包含重要的源代码信息。网站管理员在发布代码时，没有使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使.svn隐藏文件夹被暴露于外网环境，可以利用.svn/entries文件，获取到服务器源码；

###### svnExploit

https://github.com/admintony/svnExploit

```bash
git clone https://github.com/admintony/svnExploit
cd svnExploit
python3 ./SvnExploit.py -u http://www.baidu.com/.svn
python3 ./SvnExploit.py -u http://192.168.27.128/.svn
python3 ./SvnExploit.py -u http://192.168.27.128/.svn --dump
```

`--dump` 一下

这样源码就被我们dump下来了

```bash
# python3 SvnExploit.py -h
Usage: SvnExploit.py [options]

Options:
  -h, --help           show this help message and exit
  -u URL, --url=URL    TargetURL e.g.http://url/.svn
  --thread=THREAD_NUM  The thread num default is 5
  --dump               Dump file
```

###### 练习：ctfhub-web-信息泄露-svn泄露

![image-20240826194013674](../../../../repo/assets/24_2.信息收集/image-20240826194013674.png)

![image-20240826194246967](../../../../repo/assets/24_2.信息收集/image-20240826194246967.png)

![image-20240826194517470](../../../../repo/assets/24_2.信息收集/image-20240826194517470.png)

```
python3 ./SvnExploit.py -u http://challenge-b4521580a7e902c5.sandbox.ctfhub.com:10800/.svn
```

![image-20240826194634076](../../../../repo/assets/24_2.信息收集/image-20240826194634076.png)

```
python3 ./SvnExploit.py -u http://challenge-b4521580a7e902c5.sandbox.ctfhub.com:10800/.svn --dump
```

![image-20240826194730786](../../../../repo/assets/24_2.信息收集/image-20240826194730786.png)

##### HG泄露

```
inurl="hg"
```



###### dvcs-ripper

https://github.com/kost/dvcs-ripper.git

```bash
git clone https://github.com/kost/dvcs-ripper.git
cd dvcs-ripper

sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl
sudo apt-get install libparallel-forkmanager-perl libredis-perl libalgorithm-combinatorics-perl
sudo apt-get install cvs subversion git bzr mercurial

rip-git.pl -v -u http://www.example.com/.git/
rip-svn.pl -v -u http://www.example.com/.svn/
rip-hg.pl -v -u http://www.example.com/.hg/
rip-bzr.pl -v -u http://www.example.com/.bzr/
rip-cvs.pl -v -u http://www.example.com/CVS/
```



###### 靶场：ctfhub-web-信息泄露-HG泄露

![image-20240826195400883](../../../../repo/assets/24_2.信息收集/image-20240826195400883.png)

```
rip-hg.pl -v -u http://challenge-89229a1e0bb79e46.sandbox.ctfhub.com:10800/.hg/
```

![image-20240826201129468](../../../../repo/assets/24_2.信息收集/image-20240826201129468.png)

##### DS_Store文件泄露

```
inurl=".DS_Store"
```

###### 靶场：ctfhub-web-信息泄露-备份文件下载-.DS_Store

![image-20240826202618598](../../../../repo/assets/24_2.信息收集/image-20240826202618598.png)

![image-20240826202940831](../../../../repo/assets/24_2.信息收集/image-20240826202940831.png)

![image-20240826202957802](../../../../repo/assets/24_2.信息收集/image-20240826202957802.png)

```
python3 ds_store_exp.py http://challenge-cae4360332dcf9c0.sandbox.ctfhub.com:10800/.DS_Store
```

![image-20240826203043675](../../../../repo/assets/24_2.信息收集/image-20240826203043675.png)

![image-20240826203111582](../../../../repo/assets/24_2.信息收集/image-20240826203111582.png)

###### 漏洞成因

`.DS_Store`是Mac OS保存文件夹的自定义属性的隐藏文件，如文件的图标位置或背景色，相当于Windows的`desktop.ini`。

由于开发人员发布代码时未删除文件夹中隐藏的.DS_store，可能造成文件目录结构泄漏、源代码文件等敏感信息的泄露。

###### 漏洞利用

我们可以通过直接访问 `url+/.ds_store` 来判断是否存在此漏洞

利用工具： 

###### ds_store_exp

`ds_store_exp`是一个`.DS_Store` 文件泄漏利用脚本，它解析`.DS_Store`文件并递归地下载文件到本地

https://github.com/lijiejie/ds_store_exp

```bash
git clone https://github.com/lijiejie/ds_store_exp.git
cd ds_store_exp
pip install ds-store requests
python3 ds_store_exp.py https://www.baidu.com/.DS_Store
```

##### WEB-INF/web.xml泄露

```
inurl='WEB-INF'
```

###### 靶场：BUUCTF

`[RoarCTF 2019]Easy Java`

```
https://buuoj.cn/challenges#[RoarCTF%202019]Easy%20Java
```

![image-20240826203820825](../../../../repo/assets/24_2.信息收集/image-20240826203820825.png)

![image-20240826203912118](../../../../repo/assets/24_2.信息收集/image-20240826203912118.png)

![image-20240826203947333](../../../../repo/assets/24_2.信息收集/image-20240826203947333.png)

文件包含，并且有`java`类，改`post`请求

![image-20240826204150174](../../../../repo/assets/24_2.信息收集/image-20240826204150174.png)

```bash
filename=WEB-INF/web.xml
```

![image-20240826204239255](../../../../repo/assets/24_2.信息收集/image-20240826204239255.png)

```bash
filename=WEB-INF/classes/com/wm/ctf/FlagController.class
```

![image-20240826204648202](../../../../repo/assets/24_2.信息收集/image-20240826204648202.png)

![image-20240826204838608](../../../../repo/assets/24_2.信息收集/image-20240826204838608.png)

![image-20240826204903886](../../../../repo/assets/24_2.信息收集/image-20240826204903886.png)

`WEB-INF` 是`Java`的`WEB`应用的安全目录，如果想在页面中直接访问其中的文件，必须通过`web.xml`文件对要访问的文件进行相应映射才能访问。

```
WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.
WEB-INF/database.properties : 数据库配置文件
WEB-INF/classes/ : 一般用来存放Java类文件(.class)
WEB-INF/lib/ : 用来存放打包好的库(.jar)
WEB-INF/src/ : 用来放源代码(.asp和.php等)
```

通过找到 web.xml 文件，推断 class 文件的路径，最后直接 class 文件，再通过反编译 `class` 文件，得到网站源码。

##### SWP 泄露

```
inurl=".swp"
```

###### 靶场：Polar靶场

`[web]swp`

![image-20240826210803988](../../../../repo/assets/24_2.信息收集/image-20240826210803988.png)

![image-20240826210824767](../../../../repo/assets/24_2.信息收集/image-20240826210824767.png)

dirsearch跑目录

```
dirsearch -u http://4b787410-1cbf-4747-9341-2b920cd520d8.www.polarctf.com:8090/
```

![image-20240826211001473](../../../../repo/assets/24_2.信息收集/image-20240826211001473.png)

`/.index.php.swp`  

![image-20240826211033933](../../../../repo/assets/24_2.信息收集/image-20240826211033933.png)

![image-20240826211056979](../../../../repo/assets/24_2.信息收集/image-20240826211056979.png)

![image-20240826211452454](../../../../repo/assets/24_2.信息收集/image-20240826211452454.png)

##### CVS泄漏

```
inurl='cvs'
```

cvs项目在初始化(cvs checkout project)的时候, 会在project目录下创建一个名为CVS的目录,其中保存了

各个文件的修改和commit记录. 通过此目录可以获取代码的历史版本. 其中两个关键文件为:

`CVS/Root`和`CVS/Entries`, 分别记录了项目的根信息和所有文件的结构

###### 漏洞利用：

主要是针对 `CVS/Root`以及`CVS/Entries`目录，直接就可以看到泄露的信息

```bash
http://www.test.com/CVS/Root 	#返回根信息
http://www.test.com/CVS/Entries #返回所有的文件结构
```



##### Bzr泄露

```
inurl="bzr"
```



##### dumpall

https://github.com/0xHJK/dumpall

###### pip安装

```
pip install dumpall
pip install pyquery


dumpall --version
```

###### 手动下载

```bash
git clone https://github.com/0xHJK/dumpall
cd dumpall
python3 dumpall.py --version
```

###### Usage

```bash
#下载文件（源代码）
dumpall -u < url > [-o < outdir > ] 

#示例
dumpall -u http://baudu.com/.git/
dumpall -u http://baudu.com/.svn/
dumpall -u http://baudu.com/.DS_Store
dumpall -u http://baudu.com/
```

###### 帮助

```
$ dumpall --help
Usage: dumpall.py [OPTIONS]

  信息泄漏利用工具，适用于.git/.svn/.DS_Store，以及目录列出下载

  Example: dumpall -u http://example.com/.git

Options:
  --version          Show the version and exit.
  -u, --url TEXT     指定目标URL，支持.git/.svn/.DS_Store，以及类index页面
  -o, --outdir TEXT  指定下载目录，默认目录名为主机名
  -p, --proxy TEXT   指定代理 scheme://[user:pass@]hostname:port
  -f, --force        强制下载（可能会有蜜罐风险）
  -d, --debug        调试模式
  --help             Show this message and exit.
```

#### 探测软件级WAF

判断`安全狗、阿里云云盾、360网站卫士、护卫神`等WEB应用程序防火墙，便于采取绕过WAF的办法。

WAF也即**WEB应用防火墙**，是通过执行一系列针对`HTTP,HFTPS`的安全第略来专门为Weh应用提供保护的一个产品，在公要的情况下还是可以对WAF进行探测，了解WA的种类和版本，并尝试使用一些手段线过WAF规则.

##### 测试方法:

1. (1)手工`Fuzzing`——提交恶意数据,直接粗暴
2. (2)工具测试——`WAFWOOF`、`Nmap`等

##### (1) D盾

##### (2) 云锁

##### (3) 宝塔网站防火墙

##### (4) 网站安全狗

其他的可以查看该网址：https://www.cnblogs.com/charon1937/p/13799467.html

##### 工具探测：

###### WAFw00f

WAFw00f是Python脚本，用于检测网络服务器是否处于网络应用的防火墙（WAF ，Web application firewall）保护状态。不仅可以发展测试战略，而且能够开发绕过应用网络防火墙的高级技术WAFw00f其工作原理是首先通过发送一个正常的http请求，然后观察其返回有没有一些特征字符，若没有再通过发送一个恶意的请求触发WAF拦截来获取其返回的特征来判断所使用的WAF。

```bash
wafw00f -a chaitin.cn
```

 kali自带

```bash
# wafw00f -h                                                                           
Usage: wafw00f url1 [url2 [url3 ... ]]
example: wafw00f http://www.victim.org/

Options:
  -h, --help            show this help message and exit
  -v, --verbose         Enable verbosity, multiple -v options increase
                        verbosity
  -a, --findall         Find all WAFs which match the signatures, do not stop
                        testing on the first one
  -r, --noredirect      Do not follow redirections given by 3xx responses
  -t TEST, --test=TEST  Test for one specific WAF
  -o OUTPUT, --output=OUTPUT
                        Write output to csv, json or text file depending on
                        file extension. For stdout, specify - as filename.
  -f FORMAT, --format=FORMAT
                        Force output format to csv, json or text.
  -i INPUT, --input-file=INPUT
                        Read targets from a file. Input format can be csv,
                        json or text. For csv and json, a `url` column name or
                        element is required.
  -l, --list            List all WAFs that WAFW00F is able to detect
  -p PROXY, --proxy=PROXY
                        Use an HTTP proxy to perform requests, examples:
                        http://hostname:8080, socks5://hostname:1080,
                        http://user:pass@hostname:8080
  -V, --version         Print out the current version of WafW00f and exit.
  -H HEADERS, --headers=HEADERS
                        Pass custom headers via a text file to overwrite the
                        default header set.
```



###### Nmap 探测WAF

```bash
nmap -p80,443 --script=http-waf-detect baidu.com
nmap -p80,443 --script=http-waf-fingerprint baidu.com
```

![image-20240823154934154](../../../../repo/assets/24_2.信息收集/image-20240823154934154.png)

#### 旁站、C段

##### 旁站：

同服务器其他站点；

旁注攻击就是说在攻击目标时，对目标网站“无法下手”找不到目标网站的漏洞，那么攻击者就可以通过在与目标站点同一服务器下的站点渗透，从而获取目标站点的权限，这过程就是旁注攻击；

##### C段：

同一网段其他服务器，主站防护较强，转变目标到该站点子服务器。拿子服务器，提权拿服务器权限。主站权限自然拿到；网站不存在旁站，进行C段探测（有些网站买断了相邻的几个IP做为分站，如果拿到分站的管理员敏感信息，如密码之类的，可以尝试对主站进行撞库）对于实战攻防工程师来说，C段扫描比较有意义，对于单独网站渗透，C段扫描意义不大。

- fofa、shodan在线工具：`ip="106.15.141.18/24"`
- 在线webscan：https://webscan.cc/

![image-20240823155508029](../../../../repo/assets/24_2.信息收集/image-20240823155508029.png)

#### 敏感目录

- 扫描站点的目录，寻找敏感文件，如目录名，后台，robots.txt、备份文件等
- 目录：站点结构，权限控制不严格，弱口令，万能密码，爆破
- 探针文件：服务器配置信息， 1.php、phpinfo.php、readme.txt、config.txt 等
- robots.txt: 一般存放在站点根目录，如果管理员对robots.txt配置不合理就会造成信息泄露
- 备份文件：数据库备份，网站备份文件，如.bak 文件，.zip文件，.rar文件等
- 敏感JS文件：网页中可能嵌套的JS存在敏感信息，如后台的入口，登录评估等
- API：网页中可能存在嵌套的应用程序接口，在信息收集中可以考虑寻找接口
- 网页链接：收集页面中包含所有的链接
- 安装包：获取数据库信息，甚至是网站源码；安装页面 ：可以二次安装进而绕过；
- mysql管理接口：弱口令、爆破，万能密码；

##### 敏感目录信息

针对目标Web目录结构和敏感隐藏文件探测是非常重要的，在探测过程中很可能会探测到后台页面、上传页面、数据库文件，甚至是网站源代码文件等。

通常我们所说的敏感文件、敏感目录大概有以下几种：

```
后台
robots.txt
数据库log
sitemap.xml
mysql.sql
licence.txt
Git
hg/Mercurial
svn/Subversion
bzr/Bazaar
Cvs
WEB-INF泄露
备份文件泄露、配置文件泄露
```

##### 常见的探测工具包括：

- 御剑后台扫描工具

- dirsearch

##### dirsearch

  基于 python的命令行工具，用于暴力扫描页面结构，包括网站中的目录、备份文件、编辑器、后台等敏感目录

###### 1、特点:

1. 多线程，使其比任何其他站点扫描仪工具都快
2. 执行递归暴力破解
3. 具有HTTP代理支持
4. 有效地检测到无效网页
5. 具有用户代理随机化和批处理功能
6. 支持请求延迟

###### 2、github安装

运行环境:必须安装`python3`

下载地址:https://github.com/maurosoria/dirsearch

```bash
python dirsearch.py -h 
```

###### 3、apt安装

```bash
apt install dirsearch

dirsearch -u https://www.baidu.com
dirsearch -u https://www.baidu.com -i 200
```

![image-20240823163553580](../../../../repo/assets/24_2.信息收集/image-20240823163553580.png)

###### 4、帮助

```bash
# dirsearch -h
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict
Usage: dirsearch.py [-u|--url] target [-e|--extensions] extensions [options]

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit

  Mandatory:
    -u URL, --url=URL   Target URL(s), can use multiple flags
    -l PATH, --url-file=PATH
                        URL list file
    --stdin             Read URL(s) from STDIN
    --cidr=CIDR         Target CIDR
    --raw=PATH          Load raw HTTP request from file (use `--scheme` flag
                        to set the scheme)
    -s SESSION_FILE, --session=SESSION_FILE
                        Session file
    --config=PATH       Full path to config file, see 'config.ini' for example
                        (Default: config.ini)

  Dictionary Settings:
    -w WORDLISTS, --wordlists=WORDLISTS
                        Customize wordlists (separated by commas)
    -e EXTENSIONS, --extensions=EXTENSIONS
                        Extension list separated by commas (e.g. php,asp)
    -f, --force-extensions
                        Add extensions to the end of every wordlist entry. By
                        default dirsearch only replaces the %EXT% keyword with
                        extensions
    -O, --overwrite-extensions
                        Overwrite other extensions in the wordlist with your
                        extensions (selected via `-e`)
    --exclude-extensions=EXTENSIONS
                        Exclude extension list separated by commas (e.g.
                        asp,jsp)
    --remove-extensions
                        Remove extensions in all paths (e.g. admin.php ->
                        admin)
    --prefixes=PREFIXES
                        Add custom prefixes to all wordlist entries (separated
                        by commas)
    --suffixes=SUFFIXES
                        Add custom suffixes to all wordlist entries, ignore
                        directories (separated by commas)
    -U, --uppercase     Uppercase wordlist
    -L, --lowercase     Lowercase wordlist
    -C, --capital       Capital wordlist

  General Settings:
    -t THREADS, --threads=THREADS
                        Number of threads
    -r, --recursive     Brute-force recursively
    --deep-recursive    Perform recursive scan on every directory depth (e.g.
                        api/users -> api/)
    --force-recursive   Do recursive brute-force for every found path, not
                        only directories
    -R DEPTH, --max-recursion-depth=DEPTH
                        Maximum recursion depth
    --recursion-status=CODES
                        Valid status codes to perform recursive scan, support
                        ranges (separated by commas)
    --subdirs=SUBDIRS   Scan sub-directories of the given URL[s] (separated by
                        commas)
    --exclude-subdirs=SUBDIRS
                        Exclude the following subdirectories during recursive
                        scan (separated by commas)
    -i CODES, --include-status=CODES
                        Include status codes, separated by commas, support
                        ranges (e.g. 200,300-399)
    -x CODES, --exclude-status=CODES
                        Exclude status codes, separated by commas, support
                        ranges (e.g. 301,500-599)
    --exclude-sizes=SIZES
                        Exclude responses by sizes, separated by commas (e.g.
                        0B,4KB)
    --exclude-text=TEXTS
                        Exclude responses by text, can use multiple flags
    --exclude-regex=REGEX
                        Exclude responses by regular expression
    --exclude-redirect=STRING
                        Exclude responses if this regex (or text) matches
                        redirect URL (e.g. '/index.html')
    --exclude-response=PATH
                        Exclude responses similar to response of this page,
                        path as input (e.g. 404.html)
    --skip-on-status=CODES
                        Skip target whenever hit one of these status codes,
                        separated by commas, support ranges
    --min-response-size=LENGTH
                        Minimum response length
    --max-response-size=LENGTH
                        Maximum response length
    --max-time=SECONDS  Maximum runtime for the scan
    --exit-on-error     Exit whenever an error occurs

  Request Settings:
    -m METHOD, --http-method=METHOD
                        HTTP method (default: GET)
    -d DATA, --data=DATA
                        HTTP request data
    --data-file=PATH    File contains HTTP request data
    -H HEADERS, --header=HEADERS
                        HTTP request header, can use multiple flags
    --header-file=PATH  File contains HTTP request headers
    -F, --follow-redirects
                        Follow HTTP redirects
    --random-agent      Choose a random User-Agent for each request
    --auth=CREDENTIAL   Authentication credential (e.g. user:password or
                        bearer token)
    --auth-type=TYPE    Authentication type (basic, digest, bearer, ntlm, jwt,
                        oauth2)
    --cert-file=PATH    File contains client-side certificate
    --key-file=PATH     File contains client-side certificate private key
                        (unencrypted)
    --user-agent=USER_AGENT
    --cookie=COOKIE     

  Connection Settings:
    --timeout=TIMEOUT   Connection timeout
    --delay=DELAY       Delay between requests
    --proxy=PROXY       Proxy URL (HTTP/SOCKS), can use multiple flags
    --proxy-file=PATH   File contains proxy servers
    --proxy-auth=CREDENTIAL
                        Proxy authentication credential
    --replay-proxy=PROXY
                        Proxy to replay with found paths
    --tor               Use Tor network as proxy
    --scheme=SCHEME     Scheme for raw request or if there is no scheme in the
                        URL (Default: auto-detect)
    --max-rate=RATE     Max requests per second
    --retries=RETRIES   Number of retries for failed requests
    --ip=IP             Server IP address

  Advanced Settings:
    --crawl             Crawl for new paths in responses

  View Settings:
    --full-url          Full URLs in the output (enabled automatically in
                        quiet mode)
    --redirects-history
                        Show redirects history
    --no-color          No colored output
    -q, --quiet-mode    Quiet mode

  Output Settings:
    -o PATH, --output=PATH
                        Output file
    --format=FORMAT     Report format (Available: simple, plain, json, xml,
                        md, csv, html, sqlite)
    --log=PATH          Log file
```

##### dirb命令工具

```bash
## 使用/usr/share/wordlists/dirb/big.txt 字典来扫描Web服务
dirb http://www.shouhuola.com /usr/share/wordlists/dirb/big.txt

## 设置UA和cookie
dirb http://www.shouhuola.com -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64;rv:75.0) Gecko/20100101 Firefox/75.0" -c "BAIDUID=D5C6351DAC89EF8811A51DF3A9A9C0C4:FG=1; HMACCOUNT=2906306413846532;BIDUPSID=D5C6351DAC89EF8811A51DF3A9A9C0C4; PSTM=1585744543;BDORZ=FFFB88E999055A3F8A630C64834BD6D0; H_PS_PSSID=30974_1438_31124_21098;HMVT=6bcd52f51e9b3dce32bec4a3997715ac|1587436663|; delPer=0; PSINO=6;BDRCVFR[gltLrB7qNCt]=mk3SLVN4HKm"

## 对每个字典添加.dist后缀并延迟100毫米
dirb http://192.168.11.128 -X .dist -z 100 -o test.txt

## 使用代理
dirb http://www.shouhuola.com -p 192.168.70.1:7890
```

![image-20240823164033303](../../../../repo/assets/24_2.信息收集/image-20240823164033303.png)

```bash
# dirb       

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

dirb <url_base> [<wordlist_file(s)>] [options]

========================= NOTES =========================
 <url_base> : Base URL to scan. (Use -resume for session resuming)
 <wordlist_file(s)> : List of wordfiles. (wordfile1,wordfile2,wordfile3...)

======================== HOTKEYS ========================
 'n' -> Go to next directory.
 'q' -> Stop scan. (Saving state for resume)
 'r' -> Remaining scan stats.

======================== OPTIONS ========================
 -a <agent_string> : Specify your custom USER_AGENT.
 -b : Use path as is.
 -c <cookie_string> : Set a cookie for the HTTP request.
 -E <certificate> : path to the client certificate.
 -f : Fine tunning of NOT_FOUND (404) detection.
 -H <header_string> : Add a custom header to the HTTP request.
 -i : Use case-insensitive search.
 -l : Print "Location" header when found.
 -N <nf_code>: Ignore responses with this HTTP code.
 -o <output_file> : Save output to disk.
 -p <proxy[:port]> : Use this proxy. (Default port is 1080)
 -P <proxy_username:proxy_password> : Proxy Authentication.
 -r : Don't search recursively.
 -R : Interactive recursion. (Asks for each directory)
 -S : Silent Mode. Don't show tested words. (For dumb terminals)
 -t : Don't force an ending '/' on URLs.
 -u <username:password> : HTTP Authentication.
 -v : Show also NOT_FOUND pages.
 -w : Don't stop on WARNING messages.
 -X <extensions> / -x <exts_file> : Append each word with this extensions.
 -z <millisecs> : Add a milliseconds delay to not cause excessive Flood.
```

> -a 设置user-agent
>
> -p proxy[:port]设置代理
>
> -c 设置cookie
>
> -z 添加毫秒延迟，避免洪水攻击
>
> -o 输出结果
>
> -X 在每个字典的后面添加一个后缀
>
> -H 添加请求头
>
> -i 不区分大小写搜索

##### 7kbscan

github：https://github.com/7kbstorm/7kbscan-WebPathBrute

windows下载地址：https://github.com/7kbstorm/7kbscan-WebPathBrute/releases/download/1.62/7kbscan-WebPathBrute.1.6.2.zip

![image-20240823165804088](../../../../repo/assets/24_2.信息收集/image-20240823165804088.png)



##### dirbuster

扫描工具

1. (1) `TargetURL`:输入要探测网站的地址;需要注意的是这个地址要加上协议，看网站是http还是https。
2. (2) `WorkMethod`:选择工作方式;一个是get请求，一个是自动选择。一般选autoswitch的自动选择，它会自行判断是使用head方式或get方式。
3. (3) `Number of Thread`:是选择扫描线程数，一般为20。电脑配置好的可根据情况选择。
4. (4) `selectscanningtype`:是选择扫描类型，istbased bnute force是使用字典扫猫的意思，勾选上，
5. 随后browse选择字典文件，可用自己的，也可用dituster自已的，pure brnute fore是纯暴力破解的意思
6. (5) `select slarting oplions`:选项一个是standard start point(周定标准的名字去授)，一个是unfu2z(相当于按关键字模糊授索)，选择ur 1u22,随后在unt0fuzz框中输入{dl)即可。如果你扫描的目标是http://www.xxx.com/admin/，那么就要在URL fuzz里填写"/admin/{dir}",意思是在"{dir}“的前后可以随意拼接你想要的目录或者后缀，例如输入”: /admin/{dir}.php"就表示扫描admin目录下的所有php文件

https://www.bilibili.com/read/cv8447277/

https://www.cnblogs.com/ananing/p/13688404.html



![image-20240823170149961](../../../../repo/assets/24_2.信息收集/image-20240823170149961.png)

![image-20240823170229105](../../../../repo/assets/24_2.信息收集/image-20240823170229105.png)

![image-20240823170306862](../../../../repo/assets/24_2.信息收集/image-20240823170306862.png)

##### dirb

kali自带简易目录扫描工具

```bash
dirb http://www.baidu.com
dirb http://www.baidu.com /usr/share/wordlists/dirb/big.txt
```

![image-20240823171232195](../../../../repo/assets/24_2.信息收集/image-20240823171232195.png)

```bash
# dirb                     

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

dirb <url_base> [<wordlist_file(s)>] [options]

========================= NOTES =========================
 <url_base> : Base URL to scan. (Use -resume for session resuming)
 <wordlist_file(s)> : List of wordfiles. (wordfile1,wordfile2,wordfile3...)

======================== HOTKEYS ========================
 'n' -> Go to next directory.
 'q' -> Stop scan. (Saving state for resume)
 'r' -> Remaining scan stats.

======================== OPTIONS ========================
 -a <agent_string> : Specify your custom USER_AGENT.
 -b : Use path as is.
 -c <cookie_string> : Set a cookie for the HTTP request.
 -E <certificate> : path to the client certificate.
 -f : Fine tunning of NOT_FOUND (404) detection.
 -H <header_string> : Add a custom header to the HTTP request.
 -i : Use case-insensitive search.
 -l : Print "Location" header when found.
 -N <nf_code>: Ignore responses with this HTTP code.
 -o <output_file> : Save output to disk.
 -p <proxy[:port]> : Use this proxy. (Default port is 1080)
 -P <proxy_username:proxy_password> : Proxy Authentication.
 -r : Don't search recursively.
 -R : Interactive recursion. (Asks for each directory)
 -S : Silent Mode. Don't show tested words. (For dumb terminals)
 -t : Don't force an ending '/' on URLs.
 -u <username:password> : HTTP Authentication.
 -v : Show also NOT_FOUND pages.
 -w : Don't stop on WARNING messages.
 -X <extensions> / -x <exts_file> : Append each word with this extensions.
 -z <millisecs> : Add a milliseconds delay to not cause excessive Flood.

======================== EXAMPLES =======================
 dirb http://url/directory/ (Simple Test)
 dirb http://url/ -X .html (Test files with '.html' extension)
 dirb http://url/ /usr/share/dirb/wordlists/vulns/apache.txt (Test with apache.txt wordlist)
 dirb https://secure_url/ (Simple Test with SSL)
```



#### JS信息

现如今越来越多的网站使用webpack技术，开发人员通常会把api路由打包进JS文件，JS文件中往往会暴露出许多信息，比如一些注释中的敏感信息，内网ip地址泄露，还有一些绝对路径或者相对路径的url, 这些url中很有可能就存在一些未授权访问或者其他漏洞，进行JS文件扫描对于渗透工作是非常有必要 的。

##### 常用工具：

`JSFinder 、JSFinder plus`

###### JSFinder 

JSFinder是一款快速在网站的js文件中提取URL，子域名的工具。

https://github.com/Threezh1/JSFinder

https://github.com/mickeystone/JSFinderPlus

```bash
python JSFinder.py -u https://baidu.com
```

![image-20240823170809974](../../../../repo/assets/24_2.信息收集/image-20240823170809974.png)

```bash
# python JSFinder.py -h
usage: JSFinder.py [-h] [-u URL] [-c COOKIE] [-f FILE] [-ou OUTPUTURL] [-os OUTPUTSUBDOMAIN] [-j] [-d]

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     The website
  -c COOKIE, --cookie COOKIE
                        The website cookie
  -f FILE, --file FILE  The file contains url or js
  -ou OUTPUTURL, --outputurl OUTPUTURL
                        Output file name.
  -os OUTPUTSUBDOMAIN, --outputsubdomain OUTPUTSUBDOMAIN
                        Output file name.
  -j, --js              Find in js file
  -d, --deep            Deep find

Example: python JSFinder.py -u http://www.baidu.
```

###### JSFinderPlus

https://github.com/mickeystone/JSFinderPlus

```
git clone https://github.com/mickeystone/JSFinderPlus.git
cd JSFinderPlus
python JSFinderPlus.py -u http://baidu.com
```

![image-20240823172134981](../../../../repo/assets/24_2.信息收集/image-20240823172134981.png)

![image-20240823172209917](../../../../repo/assets/24_2.信息收集/image-20240823172209917.png)

```bash
# python JSFinderPlus.py -h

     ____. ____________________.__            .___          __________.__
    |    |/   _____/\_   _____/|__| ____    __| _/__________\______   \  |  __ __  ______
    |    |\_____  \  |    __)  |  |/    \  / __ |/ __ \_  __ \     ___/  | |  |  \/  ___/
/\__|    |/        \ |     \   |  |   |  \/ /_/ \  ___/|  | \/    |   |  |_|  |  /\___ \
\________/_______  / \___  /   |__|___|  /\____ |\___  >__|  |____|   |____/____//____  >
                 \/      \/            \/      \/    \/                               \/

usage: python3 JSFinderPlus.py [options]

target:
  you must to specify target

  -u URL, --url URL     target URL (e.g. -u "http://example.com")

general:
  general options

  -h, --help            show this help message and exit
  -t NUM, --thread NUM  扫描线程，默认10
  -d                    对发现的URL进行查找，默认只查找输入的URL
  --open                立即打开报告
  --site-root ROOT      指定URL的根目录
  --proxy-socks SOCKS   socks proxy (e.g. --proxy-socks 127.0.0.1:1080)
  --proxy-http HTTP     http proxy (e.g. --proxy-http 127.0.0.1:8080)
  -c COOKIE             cookie
  --user-agent UA       you can customize the user-agent headers

examples:
  python3 JSFinderPlus.py -u http://example.com
  python3 JSFinderPlus.py -u http://example.com -d
  python3 JSFinderPlus.py -u http://example.com:7001/index --site-root http://example.com:7001/#/
  python3 JSFinderPlus.py -f list.txt -d -t 20
  python3 JSFinderPlus.py -f list.txt -o results.text
```

###### Packer-Fuzzer

```bash
sudo apt-get install nodejs && sudo apt-get install npm

git clone https://gitee.com/keyboxdzd/Packer-Fuzzer.git
pip3 install -r requirements.txt

python3 PackerFuzzer.py -u https://www.liaoxuefeng.com
```

###### URLFinder

https://github.com/pingc0y/URLFinder

```bash
URLFinder.exe -u baidu.com
URLFinder.exe -s all -m 2 -u https://www.baidu.cn/  -o 1.csv
```

![image-20240823171108230](../../../../repo/assets/24_2.信息收集/image-20240823171108230.png)

```bash
# URLFinder.exe -h
         __   __   ___ _           _
 /\ /\  /__\ / /  / __(_)_ __   __| | ___ _ __
/ / \ \/ \/// /  / _\ | | '_ \ / _` |/ _ \ '__|
\ \_/ / _  \ /___ /   | | | | | (_| |  __/ |
 \___/\/ \_\____\/    |_|_| |_|\__,_|\___|_|

By: pingc0y
Update: 2023.9.9 | 更新检测失败
Github: https://github.com/pingc0y/URLFinder

Usage: URLFinder [-a user-agent] [-b baseurl] [-c cookie] [-d domainName] [-f urlFile] [-ff urlFile one]  [-h help]  [-i configFile]  [-m mode] [-max maximum] [-o outFile]  [-s Status] [-t thread] [-time timeout] [-u url] [-x proxy] [-z fuzz]

Options:
  -a string
        set user-agent
        设置user-agent请求头
  -b string
        set baseurl
        设置baseurl路径
  -c string
        set cookie
        设置cookie
  -d string
        set domainName
        指定获取的域名,支持正则表达式
  -f string
        set urlFile
        批量抓取url,指定文件路径
  -ff string
        set urlFile one
        与-f区别：全部抓取的数据,视为同一个url的结果来处理（只打印一份结果 | 只会输出一份结果）
  -h    this help
        帮助信息
  -i    set configFile
        加载yaml配置文件（不存在时,会在当前目录创建一个默认yaml配置文件）
  -m int
        set mode
        抓取模式
           1 normal
             正常抓取（默认）
           2 thorough
             深入抓取（默认url深入一层,js深入三层,-i可以自定义）
           3 security
             安全深入抓取（过滤delete,remove等敏感路由.-i可自定义）  (default 1)
  -max int
        set maximum
        最大抓取链接数 (default 99999)
  -o string
        set outFile
        结果导出到csv、json、html文件,需指定导出文件目录,可填写完整文件名只导出一种类型（.代表当前目录）
  -s string
        set Status
        显示指定状态码,all为显示全部（多个状态码用,隔开）
  -t int
        set Thread
        设置线程数（默认50） (default 50)
  -time int
        set Timeout
        设置超时时间（默认5,单位秒） (default 5)
  -u string
        set Url
        目标URL
  -x string
        set Proxy
        设置代理,格式: http://username:password@127.0.0.1:8809
  -z int
        set Fuzz
        对404链接进行fuzz(只对主域名下的链接生效,需要与 -s 一起使用）
           1 decreasing
             目录递减fuzz
           2 2combination
             2级目录组合fuzz（适合少量链接使用）
           3 3combination
             3级目录组合fuzz（适合少量链接使用）
```

#### 搜索引擎

##### FOFA网络空间测绘: 

https://fofa.info/

https://blog.csdn.net/weixin_44556964/article/details/130263348

```bash
逻辑连接符
 
=    匹配，=""时，可查询不存在字段或者值为空的情况。
==   完全匹配，==""时，可查询存在且值为空的情况。
&&   与  
||   或者
!=   不匹配，!=""时，可查询值为空的情况。
*=   模糊匹配，使用*或者?进行搜索，比如banner*="mys??" (个人版及以上可用)。
()   确认查询优先级，括号内容优先级最高。
 
 
title="beijing"                   从标题中搜索“北京”
 
header="elastic"                  从http头中搜索“elastic”
-
body="网络空间测绘"                从html正文中搜索“网络空间测绘”
-
fid="sSXXGNUO2FefBTcCLIT/2Q=="    查找相同的网站指纹
 
domain="qq.com"                   搜索根域名带有qq.com的网站
-
icp="京ICP证030173号"             查找备案号为“京ICP证030173号”的网站
 
js_name="js/jquery.js"           查找网站正文中包含js/jquery.js的资产
 
js_md5="82ac3f14327a8b7ba49baa208d4eaa15"   查找js源码与之匹配的资产
-
cname="ap21.inst.siteforce.com"  查找cname为"ap21.inst.siteforce.com"的网站
-
cname_domain="siteforce.com"     查找cname包含“siteforce.com”的网站
-
cloud_name="Aliyundun"           通过云服务名称搜索资产
-
product="NGINX"                  搜索此产品的资产
 
category="服务"                  搜索此产品分类的资产
 
icon_hash="-247388890"           搜索使用此 icon 的资产
 
host=".gov.cn"                   从url中搜索”.gov.cn”搜索要用host作为名称
port="6379"                      查找对应“6379”端口的资产
-
ip="1.1.1.1"                     从ip中搜索包含“1.1.1.1”的网站搜索要用ip作为名称
ip="220.181.111.1/24"            查询IP为“220.181.111.1”的C网段资产
-
status_code="402"                查询服务器状态为“402”的资产
 
protocol="quic"                  查询quic协议资产
 
country="CN"                     搜索指定国家(编码)的资产
-
region="Xinjiang Uyghur Autonomous Region"   搜索指定行政区的资产
-
city="Ürümqi"                    搜索指定城市的资产
-
cert="baidu"                    搜索证书(https或者imaps等)中带有baidu的资产
-
cert.subject="Oracle Corporation" 搜索证书持有者是Oracle Corporation的资产
-
cert.issuer="DigiCert"            搜索证书颁发者为DigiCert Inc的资产
-
cert.is_valid=true                验证证书是否有效，true有效，false无效
 
cert.is_match=true                证书和域名是否匹配；true匹配、false不匹配
 
cert.is_expired=false             证书是否过期；true过期、false未过期
 
jarm="2ad...83e81"                搜索JARM指纹
-
banner="users" && protocol="ftp"  搜索FTP协议中带有users文本的资产
-
type="service"                    搜索所有协议资产，支持subdomain和service两种
 
os="centos"                       搜索CentOS资产
-
server=="Microsoft-IIS/10"        搜索IIS 10服务器
-
app="Microsoft-Exchange"          搜索Microsoft-Exchange设备
-
after="2017" && before="2017-10-01" 时间范围段搜索
-
asn="19551"                        搜索指定asn的资产
-
org="LLC Baxet"                   搜索指定org(组织)的资产
-
base_protocol="udp"               搜索指定udp协议的资产
-
 
is_domain=true                    搜索域名的资产,只接受true和false
is_cloud=true                     筛选使用了云服务的资产
-
port_size="6"                     查询开放端口数量等于"6"的资产
 
port_size_gt="6"                  查询开放端口数量大于"6"的资产
 
port_size_lt="12"                  查询开放端口数量小于"12"的资产
 
ip_ports="80,161"                  搜索同时开放80和161端口的ip
ip_country="CN"                    搜索中国的ip资产
ip_region="Zhejiang"               搜索指定行政区的ip资产(以ip为单位的资产数据)
 
ip_city="Hangzhou"                 搜索指定城市的ip资产(以ip为单位的资产数据)
 
ip_after="2021-03-18"              搜索2021-03-18以后的ip资产
ip_before="2019-09-09"             搜索2019-09-09以前的ip资产
```

##### Zoomeye：

https://www.zoomeye.org/

```bash
app: 组件名（web服务应用程序：nginx、apache、IIS、weblogic等等）
ver: 组件版本

例1：搜索使用iis6.0主机：app:"Microsoft-IIS" ver"6.0"
例2：搜索使weblogic主机：app:"weblogic httpd" port:7001
例3：查询开放3389端口的主机：port:3389
例4：查询操作系统为Linux系统的服务器，os:linux
例5：查询公网摄像：service:”routersetup”
例6：搜索美国的 Apache 服务器：app:Apache country:US 后面还可以接city: 城市名称
例7：搜索指定ip信息，ip:121.42.173.26
例8：查询有关taobao.com域名的信息，site:taobao.com
例9：搜索标题中包含该字符的网站，title:weblogic
例10：关键字查询，keywords:Nginx
```

##### Shodan：

https://www.shodan.io/

```bash
hostname：搜索指定的主机或域名，例如 hostname:"google"
port：搜索指定的端口或服务，例如 port:"21"
country：搜索指定的国家，例如 country:"CN"
city：搜索指定的城市，例如 city:"Hefei"
org：搜索指定的组织或公司，例如 org:"google"
isp：搜索指定的ISP供应商，例如 isp:"China Telecom"
product：搜索指定的操作系统/软件/平台，例如 product:"Apache httpd"
version：搜索指定的软件版本，例如 version:"1.6.2"
geo：搜索指定的地理位置，参数为经纬度，例如 geo:"31.8639, 117.2808"
before/after：搜索指定收录时间前后的数据，格式为dd-mm-yy，例如 before:"11-11-15"
net：搜索指定的IP地址或子网，例如 net:"210.45.240.0/24"

查询中国开发了21端口的网站： country:"CN" port:"21"
```

##### 零零信安：

https://0.zone/

###### 逻辑连接符

```bash

说明（不能包含空格，点击可搜索）
&&
且，满足A并且满足B，如：company==保险&&email===163.com
||
或，满足A或者满足B，如：company==电力建设有限公司||company==能源有限公司
( )
条件分组，条件可以使用括号括起来确定优先级，如：(company==学院||company==学校)&&(name==李)
```

###### 条件匹配符

```bash

说明（不能包含空格，点击可搜索）
=
完全相等，如：company=北京零零信安科技有限公司，查询等于空：company=""
==
包含，包含某单词或词语，如：company==microsofttitle==健康码
===
逐字符匹配，内容不是完整的单词或词语，可以尝试该匹配符，如：email===edu.com.cn
=^
开始为，如：email=^noreply
=$
结尾为，如：email=$sina.com.cn
=!
不等于，如：company==通信集团&&email=!edu.com.cn，查询不等于空：company=!""&&title==上海
==!
不包含，如：company==信息||title==!湖南
=!^
开始不为，如：title==科技&&title=!^灰科技
=!$
结尾不为，如：title==科技&&title=!$科技处
>
大于, 用于时间判断
>=
大于等于, 用于时间判断
<
小于, 用于时间判断
<=
小于等于，用于时间判断
```

###### 【信息系统】高级查询参数

```bash
company
从信息系统中搜索「所属公司」包含 "如：xxx网络科技" 的数据，如：company==网络科技
ip
从信息系统中搜索「IP / IP段」等于 "IP段格式: 10.0.0.1/24、10.0.0.1-10.0.0.34" 的数据，如：ip=39.98.171.0-39.98.171.254
url
从信息系统中搜索「URL / 域名」包含 "如：00sec.com" 的数据，如：url==00sec.com
title
从信息系统中搜索「网页标题」情报 "如：xxx网页标题" 的数据，如：title==情报
html_banner
从信息系统中搜索「HTML原文」包含 "如：零零信安" 的数据，如：html_banner==零零信安
banner
从信息系统中搜索「Banner信息」包含 "如：零零信安" 的数据，如：banner==零零信安
res_header
从信息系统中搜索「Header信息」包含 "如：nginx" 的数据，如：res_header==nginx
port
从信息系统中搜索「端口」等于 "如：80" 的数据，如：port=443
component
从信息系统中搜索「组件」包含 "如：nginx" 的数据，如：component==nginx
service
从信息系统中搜索「服务」包含 "如：http" 的数据，如：service==http
tags
从信息系统中搜索「标签」包含 "如：登录" 的数据，如：tags==登录
os
从信息系统中搜索「操作系统」包含 "如：Linux" 的数据，如：os==windows
extra_info
从信息系统中搜索「设备分类」包含 "如：负载均衡" 的数据，如：extra_info==负载均衡
app_name
从信息系统中搜索「APP名称」包含 "如：零零信安" 的数据，如：app_name==零零信安
status_code
从信息系统中搜索「状态码」等于 "如：200" 的数据，如：status_code=200
operator
从信息系统中搜索「运营商」包含 "如：电信" 的数据，如：operator==电信
device_type
从信息系统中搜索「设备」包含 "如：load balancer" 的数据，如：device_type==balancer
versions
从信息系统中搜索「版本」包含 "如：1.0" 的数据，如：versions==1.0
cms
从信息系统中搜索「CMS」包含 "如：WordPress" 的数据，如：cms==WordPress
cdn
从信息系统中搜索「CDN」等于 "如：0" 的数据，如：cdn=1
icp
从信息系统中搜索「备案号」包含 "如：备xxx" 的数据，如：icp==2022
icon
从信息系统中搜索「网站 ICON MD5」等于 "如：xxx md5 值" 的数据，如：icon=baf2ef6b13cd5157e578074ecf7bc872
ssl_info.issuer_cn
从信息系统中搜索「SSL颁发者 (Issuer CN)」包含 "如：Amazon" 的数据，如：ssl_info.issuer_cn==Amazon
ssl_info.issuer_org
从信息系统中搜索「SSL颁发机构 (Issuer O)」包含 "如：Amazon" 的数据，如：ssl_info.issuer_org==Amazon
ssl_info.subject_cn
从信息系统中搜索「SSL通用名 (Subject CN)」包含 "如：management" 的数据，如：ssl_info.subject_cn==management
ssl_info.subject_org
从信息系统中搜索「SSL关联组织 (Subject O)」包含 "如：DataDomain" 的数据，如：ssl_info.subject_org==DataDomain
ssl_info.detail
从信息系统中搜索「SSL证书详情」 "如：零零信安" 的数据，如：ssl_info.detail==001
lang
从信息系统中搜索「开发语言」包含 "如：java" 的数据，如：lang==java
country
从信息系统中搜索「地区: 国家」包含 "如：美国" 的数据，如：country==美国
province
从信息系统中搜索「地区: 省」包含 "如：四川" 的数据，如：province==四川
city
从信息系统中搜索「地区: 市」包含 "如：北京" 的数据，如：city==北京
asset_type
从信息系统中搜索「资产类型」包含 "如：其他设备:asset_type=ip,网站系统asset_type=operating" 的数据，如：asset_type=ip
explore_timestamp
从信息系统中搜索「录入时间」包含 "7天内:week、1个月内:month、6个月内:six_month、6个月前:min_six_month" 的数据，如：explore_timestamp=week
timestamp
从信息系统中搜索「更新时间」 "7天内:week、1个月内:month、6个月内:six_month、6个月前:min_six_month" 的数据，如：timestamp=week
```

###### 【移动端应用】高级查询参数

```bash
company
从移动端应用中搜索「所属公司」包含 "如：xxx网络科技" 的数据，如：company==网络科技
name
从移动端应用中搜索「应用名称」包含 "如：万能" 的数据，如：name==万能
description
从移动端应用中搜索「应用描述」包含 "如：去水印" 的数据，如：description==去水印
type
从移动端应用中搜索「应用类型」等于 "如：微信小程序、微信公众号、安卓APK" 的数据，如：type=微信小程序
```

###### 【域名】高级查询参数

```bash
company
从域名中搜索「所属公司」包含 "如：xxx网络科技" 的数据，如：company==网络科技
root_domain
从域名中搜索「根域」包含 "如：00sec.com" 的数据，如：root_domain==00sec.com
ip
从域名中搜索「IP地址」等于 "如：39.98.171.121" 的数据，如：ip=39.98.171.121
domain
从域名中搜索「子域名」等于 "如：vip.00sec.com" 的数据，如：domain=vip.00sec.com
icp
从域名中搜索「备案号」逐字匹配 "如：备2022" 的数据，如：icp===备2022
toplv_domain
从域名中搜索「域名后缀」包含 "如 com、cn、net、org等" 的数据，如：toplv_domain==org
level
从域名中搜索「域名级别」等于 "如：子域名" 的数据，如：level=子域名
```

###### 【邮箱】高级查询参数

```bash
company
从邮箱中搜索「所属公司」包含 "如：xxx网络科技" 的数据，如：company==网络科技
email
从邮箱中搜索「邮箱地址」逐字匹配 "如：@126.com" 的数据，如：email===@126.com
email_domain
从邮箱中搜索「邮箱域名」逐字匹配 "如：126.com" 的数据，如：email_domain===126.com
email_type
从邮箱中搜索「邮箱类型」等于 "如：企业邮箱" 的数据，如：email_type=企业邮箱
leakage_num
从邮箱中搜索「泄露次数」等于 "如：4" 的数据，如：leakage_num=4
source
从邮箱中搜索「来源」等于 "如：0.zone" 的数据，如：source=0.zone
msg.tags
从邮箱中搜索「标签」包含 "如：科技有限公司" 的数据，如：msg.tags==科技有限公司
```

##### Hunter鹰图

https://hunter.qianxin.com/

| 语法内容                                                  | 语法说明                                      |
| --------------------------------------------------------- | --------------------------------------------- |
| ip.tag="CDN"                                              | 查询包含IP标签"CDN"的资产 (查看枚举值)        |
| web.similar="baidu.com:443"                               | 查询与baidu.com:443网站的特征相似的资产       |
| web.similar_icon=="17262739310191283300"                  | 查询网站icon与该icon相似的资产                |
| web.similar_id="3322dfb483ea6fd250b29de488969b35"         | 查询与该网页相似的资产                        |
| web.tag="登录页面"                                        | 查询包含资产标签"登录页面"的资产 (查看枚举值) |
| domain.suffix="qianxin.com"                               | 搜索主域为"qianxin.com"的网站                 |
| web.icon="22eeab765346f14faf564a4709f98548"               | 查询网站icon与该icon相同的资产                |
| ip.port_count>"2" h                                       | 搜索开放端口大于2的IP（支持等于、大于、小于） |
| is_web=true                                               | 搜索web资产                                   |
| cert.is_trust=true                                        | 搜索证书可信的资产                            |
| ip="1.1.1.1"                                              | 搜索IP为 ”1.1.1.1”的资产                      |
| ip="220.181.111.0/24"                                     | 搜索网段为"220.181.111.0"的C段资产            |
| ip.port="80"                                              | 搜索开放端口为”80“的资产                      |
| ip.country="中国" 或 ip.country="CN"                      | 搜索IP对应主机所在国为”中国“的资产            |
| ip.province="江苏"                                        | 搜索IP对应主机在江苏省的资产                  |
| ip.city="北京"                                            | 搜索IP对应主机所在城市为”北京“市的资产        |
| ip.isp="电信"                                             | 搜索运营商为”中国电信”的资产                  |
| ip.os="Windows"                                           | 搜索操作系统标记为”Windows“的资产             |
| app="Hikvision 海康威视 Firmware 5.0+" && ip.ports="8000" | 检索使用了Hikvision且ip开放8000端口的资产     |
| ip.port_count>"2"                                         | 搜索开放端口大于2的IP（支持等于、大于、小于） |
| ip.ports="80" && ip.ports="443"                           | 查询开放了80和443端口号的资产                 |
| ip.tag="CDN"                                              | 查询包含IP标签"CDN"的资产 (查看枚举值)        |

##### 360 quake

https://quake.360.net/quake/#/index

```bash
ip：支持检索单个IP、CIDR地址段、支持IPv6地址	ip:"1.1.1.1"ip: "1.1.1.1/16"
domain：网站域名信息	domain:"360.cn"
port、ports：单一端口、同时开放多端口	port:"80"ports:"80,8080,8000"
service、services：协议和服务	service:"http"services:"rtsp,https,telnet"
cert ：SSL\TLS证书信息	cert:"baidu.com"cert:"TLSv1.2"
country、province、city：位置和属地	country:"China"province:"shanxi"province:"Inner Mongolia"city:"beijing"
```



##### 图标和信息特征

favicon.ico图标---获取目标站点的favicon.ico图标的哈希值，然后配合shodan进行目标站点资产收集，因为每个目标站点的favicon.ico图标的哈希值可能是固定值，因此可以通过该方法从shodan，fofa等去寻找更多的资产。

示例：“shodan搜索语句：`http.favicon.hash ：哈希值`。

###### 生成**图标哈希值**的利用工具：

https://github.com/devanshbatham/FavFreak

其它信息进行接搜集的技巧--通过査看站点的body里是否有目标的特征，然后利用网络空间搜索引擎(如f0fa等)对该特索，如:`body=“XX公司”`或`body=“360”`等。

###### 非常规操作:

1. 1、如果找到了目标的一处资产，但是对目标其他资产的收集无处下手时，可以查看一下该站点的body里是否有目标的特征，然后利用网络空间接索引擎(如fofa等)对该特征进行搜索，如:`body=“"XK公司”或body=“360”`等，该方式一般适用于特征明显，资产数量较多的目标，并且很多时候效果拔群。
2. 2、当通过上述方式的找到test.com的特征后，再进行body的搜索，然后再搜索到test.com的时候，此时fofa上显示的i大概率为test.com的真实IP。

##### 谷歌hacker语法

利用google hacking可以快速的对目标进行信息收集。

```bash
intext: 查找网页中含有xx关键字的网站 例：intext:login
intitle： 查找某个标题 例：intitle:后台登录
filetype： 查找某个文件类型的文件 例：filetype:doc,ppt,asp,php
inurl: 查找url中带有某字段的网站 例：inurl:php?id=
site： 在某域名中查找信息 例：site:目标站点
link：查找和相关域名做连接的网站
info：查找指定站点的一些基本信息
cache：搜索google里关于某些内容的缓存
```

搭配符号：

```
+强制搜索,即必须包含加号后面的内容;
– 把某个字忽略
~ 同意词
. 单一的通配符
*通配符，可代表多个字母
..在什么范围(1..10000)
“” 精确查询
```



```bash
site：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容， 示例：
1 site: zhihu.com 搜索跟zhihu.com相关的网页
2 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页
3 "sql注入" site:csdn.net 在csdn.net搜索跟SQL注入相关的内容
4 “网络工程师” site:pan.baidu.com 在百度网盘中国搜索网络工程师

filetype：搜索指定文件类型，示例：
1.“web安全” filetype:pdf 搜索跟安全书籍相关的PDF文件
2."nmap" filetype:ppt 搜索跟nmap相关的PPT文件

inurl：搜索URL网站存在特定关键字的网页，可以用来搜寻有注入点的网站，示例：
1 inurl:.php?id= 搜搜网址中有“php?id”的网页
2 inurl:view.php=? 搜索网址中有“view.php=”的网页
3 inurl:jsp.php=? 搜索网址中有“jsp.php=”的网页
4 inurl:asp.php=? 搜索网址中有“asp.php=”的网页
5 inurl:/admin/login.php 搜索网址中有“admin/login.php”的网页
6 inurl:login 搜索网址中有“login”等登陆网页
7 link:www.hao123.com 返回所有包含目标站点链接的页面，包括其开发人员的个人博客，开发日志，或者开放这个站点的第三方公司，合作伙伴等
8 related:www.hao123.com 返回所有与目标站点”相似”的页面，可能会包含一些通用程序信息等

intext：搜索正文存在特定关键字的网页，示例：
1 intext: Powered by Discuz 搜索discuz论坛相关的页面
2 intext: Powered by wordpress 搜索wordpress制作的博客网址
3 intext: Powered by *CMS 搜索*CMS相关的页面
4 intext: Powered by xxx inurl:login 搜索此类网址的后台登录页面

intitle：搜索标题存在特定关键字的网页，示例：
1 intitle:后台管理 搜索网页标题是“后台管理”的相关网页
2 intitle:后台管理 inurl:php 搜索网页标题是“后台管理”的PHP网页
3 intitle: index of "keyword" 搜索此关键字相关的索引目录信息
4 intitle: index of “parent directory” 搜索根目录相关的索引目录信息
5 intitle: index of “password” 搜索密码相关的索引目录信息
6 intitle: index of “login” 搜索登陆页面信息
7 intitle: index of “admin” / intitle:后台管理 inurl:admin 搜索后台管理页面信息

搜索篮球/电影等相关网站：
inurl:php?id= intitle:美剧
inurl:php?id= intitle:综艺
inurl:php?id intitle:篮球图片 intext:powered by discuz
inurl:php?id intitle:篮球图片 intext:powered by *cms

搜索用discuz搭建的论坛
inurl:php?id intitle:电影 intext:powered by discuz
intext:”powered by discuz! 7.2” inurl :faq.php intitle:论坛

搜索使用struts的相关网站
intitle:”Struts Problem Report”
intitle:”Struts Problem Report” intext:”development mode is enabled.”

查找后台地址：site:域名
inurl:login|admin|manage|member|adminlogin|loginadmin|system|login|user|main|cms

查找文本内容：site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|admin|login|sys|managetem|password|username
查找可注入点：site:域名 inurl:aspx|jsp|php|asp
查找上传漏洞：site:域名 inurl:file|load|editor|Files找eweb
编辑器：site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit
存在的数据库：site:域名 filetype:mdb|asp|#
查看脚本类型：site:域名 filetype:asp/aspx/php/jsp

admin site:edu.cn
site:example.com intext:管理|后台|登录|用户名|密码|验证码|系统|账号|后台管理|后台登录
site:example.com intitle:管理|后台|登录|用户名|密码|验证码|系统|账号|后台管理|后台登录
inurl:login/admin/manage/admin_login/login_admin/system/boos/master/main/cms/wpadmin/sys|managetem|password|usernamesite:www.sunghost.cn inurl:file
site:www.sunghost.cn inurl:load
site:www.sunghost.cn inurl:php?id=
site:www.sunghost.cn inurl:asp?id=
site:www.sunghost.cn inurl:fck
site:www.sunghost.cn inurl:ewebeditor
inurl:ewebeditor|editor|uploadfile|eweb|edit
intext:to parent directory
intext:转到父目录/转到父路径
inurl:upload.asp
inurl:cms/data/templates/images/index/
intitle:powered by dedecms
index of/ppt
Filetype:mdb
site:www.sunghost.cn intext:to parent directory+intext.mdb
inurl:robots.txt
intitle:index.of "parent directory"
```

##### search_Viewer 

github：https://github.com/G3et/Search_Viewer

下载链接：https://github.com/G3et/Search_Viewer/releases/download/v4.1/Search_Viewer_v4.1.exe

集`Fofa、Hunter鹰图、Shodan、360 quake、Zoomeye 钟馗之眼、censys` 为一体的空间测绘gui图形界面化工具

##### Github搜索

是一个分布式的版本控制系统，拥有大量的开发者用户。随着越来越多的应用程序转义到云端，Github已经成为了管理软件开发以及发现已有代码的首选方法。当今大数据时代，大规模数据泄露事件时有发生，但有些人不知道很多敏感信息的泄露其实是我们无意之间造成的。一个很小的疏漏，可能会造成一系列的连锁放映。Github上敏感信息的泄露，就是一个典型的例子，存在着一些安全隐患。

例如，我们可以使用Github找到邮件配置信息泄露，涉及一些社会工程学。

```
site:Github.com smtp
site:Github.com smtp @qq.com
再如，通过Github获取数据库泄露信息。
site:Github.com sa password
site:Github.com root password
site:Github.com User ID=‘sa’
通过Github探索SVN信息泄露信息。
site:Github.com svn
site:Github.com svn username
最后，通过Github搜索综合泄露信息。
site:Github.com password
site:Github.com ftp ftppassword
site:Github.com 密码
site:Github.com 内部
```

##### 综合泄露信息

###### gitDorker 

https://github.com/obheda12/GitDorker

```bash
git clone https://github.com/obheda12/GitDorker
cd GitDorker
pip3 install -r requirements.txt

touch token.txt
python3 GitDorker.py -tf token.txt -q tesla.com -d dorks / demo_dorks.txt
```

在当前目录下新建token.txt文件，并将生成好的Token值保存在此文件下

建议为GitDorker提供多个GitHub个人访问令牌，以便它可以在dorking过程中在多个GitHub个人访问令牌之间交替出现，并降低速率受限的可能性，使用来自单独的GitHub帐户的多个令牌将提供最佳结果。

为达到最佳效果，本次测试添加了3个Token进行使用。

```bash
# python3 GitDorker.py -h



  /$$$$$$  /$$   /$$           /$$$$$$$                      /$$
 /$$__  $$|__/  | $$          | $$__  $$                    | $$
| $$  \__/ /$$ /$$$$$$        | $$  \ $$  /$$$$$$   /$$$$$$ | $$   /$$  /$$$$$$   /$$$$$$
| $$ /$$$$| $$|_  $$_/        | $$  | $$ /$$__  $$ /$$__  $$| $$  /$$/ /$$__  $$ /$$__  $$
| $$|_  $$| $$  | $$          | $$  | $$| $$  \ $$| $$  \__/| $$$$$$/ | $$$$$$$$| $$  \__/
| $$  \ $$| $$  | $$ /$$      | $$  | $$| $$  | $$| $$      | $$_  $$ | $$_____/| $$
|  $$$$$$/| $$  |  $$$$/      | $$$$$$$/|  $$$$$$/| $$      | $$ \  $$|  $$$$$$$| $$
 \______/ |__/   \___/        |_______/  \______/ |__/      |__/  \__/ \_______/|__/


Find GitHub secrets utilizing a vast list of GitHub dorks and the GitHub search api. The
purpose of this tool is to enumerate interesting users,repos, and files to provide an
easy to read overview of where a potential sensitive information exposure may reside.

HELP: python3 GitDorker.py -h

usage: GitDorker.py [-h] [-d DORKS] [-k KEYWORD] [-q QUERY] [-qf QUERYFILE] [-ri] [-lb] [-pf] [-u USERS] [-uf USERFILE]
                    [-org ORGANIZATION] [-t TOKEN] [-tf TOKENFILE] [-e THREADS] [-p] [-o OUTPUT]

options:
  -h, --help            show this help message and exit
  -d DORKS, --dorks DORKS
                        dorks file (required)
  -k KEYWORD, --keyword KEYWORD
                        search on a keyword instead of a list of dorks
  -q QUERY, --query QUERY
                        query (required or -q)
  -qf QUERYFILE, --queryfile QUERYFILE
                        query (required or -q)
  -ri, --recentlyindexed
                        sort results of queries from most recent first
  -lb, --limitbypass    increase requests per minute when using multiple tokens from UNIQUE accounts
  -pf, --patternfilter  filter out noise/patterns for test/example keys
  -u USERS, --users USERS
                        users to perform dork or keyword search on (comma separated).
  -uf USERFILE, --userfile USERFILE
                        file containing new line separated users
  -org ORGANIZATION, --organization ORGANIZATION
                        organization's GitHub name (required or -org if query not specified)
  -t TOKEN, --token TOKEN
                        your github token (required if token file not specififed)
  -tf TOKENFILE, --tokenfile TOKENFILE
                        file containing new line separated github tokens
  -e THREADS, --threads THREADS
                        maximum n threads, default 1
  -p, --positiveresults
                        display positive results only
  -o OUTPUT, --output OUTPUT
                        output to file name (required or -o)
```

https://cloud.tencent.com/developer/article/1797734

https://www.ddosi.org/b450/

###### 在线工具：

- https://grep.app/
- https://pentest-tools.com/information-gathering/google-hacking
- https://ght.se7ensec.cn/#

#### 网盘信息：

- https://pansoso.com/

- https://www.yunpz.net/wangpan.html

- https://www.xiaomapan.com/#/main/search?restype=1


#### 漏洞库：

- https://vulners.com/

- https://www.exploit-db.com/
- https://hackerone.com/

#### APP信息收集

##### 1、apkleaks：

https://github.com/dwisiswant0/apkleaks

###### pip安装

```bash
pip3 install apkleaks
apt insatll jadx

apkleaks -f /root/file/iqiyi_16393.apk 
```

###### git安装

```bash
git clone https://github.com/dwisiswant0/apkleaks
cd apkleaks/
pip3 install -r requirements.txt

python3 apkleaks.py -f /root/file/ddniu_v4.54_3673.com.apk
python3 apkleaks.py -f /root/file/iqiyi_16393.apk --args="--deobf --log-level DEBUG"
```

![image-20240826092018699](../../../../repo/assets/24_2.信息收集/image-20240826092018699.png)

```bash
# python3 apkleaks.py -f /root/file/ddniu_v4.54_3673.com.apk 
     _    ____  _  ___               _        
    / \  |  _ \| |/ / |    ___  __ _| | _____                                                                              
   / _ \ | |_) | ' /| |   / _ \/ _` | |/ / __|                                                                             
  / ___ \|  __/| . \| |__|  __/ (_| |   <\__ \                                                                             
 /_/   \_\_|   |_|\_\_____\___|\__,_|_|\_\___/                                                                             
 v2.6.2                                                                                                                    
 --                                                                                                                        
 Scanning APK file for URIs, endpoints & secrets                                                                           
 (c) 2020-2024, dwisiswant0                                                                                                
                                                                                                                           
Can't find jadx binary.
Do you want to download jadx? (Y/n) y                                                                                      

** Downloading jadx...                                                                                                     
                                                                                                                           
** Decompiling APK...                                                                                                      
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true                                              
INFO  - loading ...
INFO  - processing ...
INFO  - done

** Scanning against 'com.dodonew.online'                                                                                   
                                                                                                                           
[Authorization_Basic]                                                                                                      
- basic =                                                                                                                  

[Generic_API_Key]                                                                                                          
- apikey" android:value="c5e4afee43c52bb00e2df9039d4aa470"                                                                 

[Generic_Secret]                                                                                                           
- Secret="2e0fa542b170e704673ae583a64dbdc7"                                                                                
- Secret="38053202e1a5fe26c80c753071f0b573"
- Secret="3837f9ce96ae3315d5908b6ae05b8d8c"
- Secret="38a4f8204cc784f81f9f0daaf31e02e3"
- Secret="ae36f4ee3946e1cbb98d6965b0b2ff5c"

[IP_Address]                                                                                                               
- 219.133.59.2                                                                                                             

[LinkFinder]                                                                                                               
- /.jiagu                                                                                                                  
- /ui
- Android/data/
- http://mob.com
- http://offlinedata.alicdn.com/amap/offlinemap/poi/unifyCompile/0TO3_18_01_08_00/a0.zip
- http://offlinedata.alicdn.com/amap/offlinemap/poi/unifyCompile/0TO3_18_01_08_00/a1.zip
- http://offlinedata.alicdn.com/amap/offlinemap/poi/unifyCompile/0TO3_18_01_08_00/a10.zip
- http://offlinedata.alicdn.com/amap/offlinemap/poi/unifyCompile/0TO3_18_01_08_00/a100.zip
- http://offlinedata.alicdn.com/amap/offlinemap/poi/unifyCompile/0TO3_18_01_08_00/a101.zip

```

###### 帮助

```bash
# python apkleaks.py -h
     _    ____  _  ___               _
    / \  |  _ \| |/ / |    ___  __ _| | _____
   / _ \ | |_) | ' /| |   / _ \/ _` | |/ / __|
  / ___ \|  __/| . \| |__|  __/ (_| |   <\__ \
 /_/   \_\_|   |_|\_\_____\___|\__,_|_|\_\___/
 v2.6.2
 --
 Scanning APK file for URIs, endpoints & secrets
 (c) 2020-2024, dwisiswant0

usage: apkleaks.py [-h] -f FILE [-o OUTPUT] [-p PATTERN] [-a ARGS] [--json]

options:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  APK file to scanning
  -o OUTPUT, --output OUTPUT
                        Write to file results (random if not set)
  -p PATTERN, --pattern PATTERN
                        Path to custom patterns JSON
  -a ARGS, --args ARGS  Disassembler arguments (e.g. --threads-count 5 --deobf)
  --json                Save as JSON format
```

##### 2、apk-getlink：

apk-getLink：https://github.com/3stoneBrother/personalTools/blob/master/scripts/apk-getLink.sh

LinkFinder：https://github.com/GerbenJavado/LinkFinder

```bash
wget https://github.com/3stoneBrother/personalTools/blob/master/scripts/apk-getLink.sh
git clone https://github.com/GerbenJavado/LinkFinder.git
apt install apktool

cd LinkFinder
pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.douban.com

cd ..
chmod +x apk-getLink.sh
./apk-getLink.sh ddniu /root/tools/app/getlink/LinkFinder	
```

#### 信息收集自动化工具

##### ShuiZe

https://github.com/0x727/ShuiZe_0x727

###### 手动安装

```bash
git clone https://github.com/0x727/ShuiZe_0x727.git
cd ShuiZe_0x727
chmod 777 build.sh
./build.sh

pip install -r requirements.txt
pip install -r requirements2.txt

pip3 uninstall numpy
pip3 install -U numpy==1.23.5

pip uninstall setuptools 
pip install setuptools==69.0.0

python3 ShuiZe.py -h

python3 ShuiZe.py -d baidu.com
```

###### docker安装

```bash
apt install docker.io

sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://hub.msqh.net","https://docker.fxxk.dedyn.io"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker

docker pull yankovg/python3.8.2-ubuntu18.04
docker run -itd yankovg/python3.8.2-ubuntu18.04 bash
docker exec -it brave_galileo /bin/bash
apt-get update
apt install git --fix-missing
apt install vim
rm /usr/bin/python3
ln -s /usr/local/bin/python3.8 /usr/bin/python3
python3 -m pip install --upgrade pip
git clone https://github.com/0x727/ShuiZe_0x727.git
chmod 777 docker_build.sh
./docker_build.sh
```

###### config.ini

```bash
vim iniFile/config.ini


[fofa api]
EMAIL = 1745272762@qq.com
KEY = 0b86c3f885b8c095462ce6d58a99d9aa

[shodan api]
SHODAN_API_KEY = 3n7iCIbg9Xv0jwQf8ZalcocJFcLTchh3

[github api]
GITHUB_TOKEN =

[quake api]
X-QuakeToken = e2f2ea84-8d51-4990-984a-57f9d214c754

[quake nums]
quake_nums = 1000

[qianxin api]
api-key = f86440c39a9ff3decde183f59d9198d128f36be26f7331f3186f0612c74d15a4
qianxin_nums = 200

[C nums]
c_nums = 5

[virustotal api]
VIRUSTOTAL_API = 7a5a35308da44bdbe7df0efab54682cbeb0f8f54f290f2fcafcaf6f97a0ab4c1

[securitytrails api]
Securitytrails_API = dtWs9gYNI2FljR_p48raBgmQKWSf1kYP

[censys api]
UID = d49a1245-8ac2-41b3-a7f6-18c6d1abccab
SECRET = OF14vPJ8bgQqKJRxRueK1Vbr7IkTSLJx

[web ports]
web_ports = ['80-90', 443, 7001, 8000, 8008, 8009, 8080, 8081, 8088, 8090, 8099, 8443, 8800, 8880, 8888, 9000, 9090]

[service ports dict]
service_ports_dict = {'389': 'ldaps', '1099': 'rmi', '1090': 'rmi', '6379': 'redis', '8000': 'jdwp', '9200': 'elastic', '27017': 'mongodb', '2181': 'zookeeper', '22': 'ssh', '21': 'ftp', '1433': 'mssql', '3306': 'mysql', '3389': 'rdp'}

[github keywords]
github_keywords = ['jdbc:', 'password', 'username', 'database', 'smtp', 'vpn', 'pwd', 'passwd', 'connect']

[nuclei config]
nuclei_config = -rl 300 -c 50 -timeout 5 -stats -silent -severity critical,high -as

# 快代理的配置，使用快代理时，根据自己购买的配置设置线程数目，switch是开关，on为使用快代理，off为不使用
[kuaidaili]
tunnel = xxxx.kdltps.com:15818
username = xxxxxxxxx
password = xxxxxxxxx
thread_num = 5
switch = off
```

###### 帮助

```bash
┌──(root㉿kali)-[~/tools/info/ShuiZe_0x727]
└─# python3 ShuiZe.py -h
    __             ____    ___     ____  
   /  \   __ __   |__  |  |_  )   |__  | 
  | () |  \ \ /     / /    / /      / /  
   \__/   /_\_\    /_/    /___|    /_/       author:ske
   
   脚本自带Linux版本的Nuclei和ksubdomain，如果是windows或者mac，需要自行更换版本。
   Plugins/infoGather/subdomain/ksubdomain/ksubdomain.py
   Plugins/Vul/Nuclei/NucleiApi.py
   最好在配置文件里填入fofa、shodan、github、censys的API，这样效果最佳。
   请一定要配置fofa的api～～～最好是高级会员
   配置文件地址：iniFile/config.ini

获取版本信息失败...
Usage: 
        python3 ShuiZe.py -d domain.com
        python3 ShuiZe.py -d domain.com --justInfoGather 1
        python3 ShuiZe.py -d domain.com --ksubdomain 0
        python3 ShuiZe.py -c 192.168.1.0,192.168.2.0,192.168.3.0
        python3 ShuiZe.py -f url.txt
        python3 ShuiZe.py -n 1 -c 192.168.1.0,192.168.2.0 -p 1.1.1.1:1111
        python3 ShuiZe.py -n 1 -f url.txt -p 1.1.1.1:1111 --web 1
        python3 ShuiZe.py -n 1 -c 192.168.1.0,192.168.2.0 -v 1
        proxychains4 python3 ShuiZe.py -n 1 -f /result/2ddcaa3ebbd0/172.18.82.0.xlsx
        proxychains4 python3 ShuiZe.py -n 1 -w 1 -f /result/2ddcaa3ebbd0/172.18.82.0.xlsx
        python3 ShuiZe.py --mn masNmap.xlsx
        python3 ShuiZe.py --mn masNmap.xlsx -w 1
        python3 ShuiZe.py --fofaTitle 大学
        python3 ShuiZe.py --domainFile domain.txt


Options:
  -h, --help            show this help message and exit
  -d DOMAIN, --domain=DOMAIN
                        target domain
  -c CSUBNET, --cSubnet=CSUBNET
                        target cSubnet
  -n ISINTRANET, --intranet=ISINTRANET
                        Scan intranet value set to 1
  -p PROXY, --proxy=PROXY
                        Intranet proxy socks5 socks4
  -f FILE, --file=FILE  /result/2ddcaa3ebbd0/172.18.82.0.xlsx
  -w WEAK, --weak=WEAK  run weak password script
  -v VPN, --vpn=VPN     Run in the case of vpn
  --web=WEB             detect web in Intranet
  --mn=MASNMAPFILE      run masscan nmap result
  --fofaTitle=FOFATITLE
                        run fofa title
  --domainFile=DOMAINFILE
                        run domain title
  --ksubdomain=KSUBDOMAIN
                        not run ksubdomain
  --test=TESTDEMO       if test=1 then run testDemo
  --justInfoGather=JUSTINFOGATHER
                        just infoGather, not detect vul
  --getSocks=GETSOCKS   get socks
```

##### linglong:(非必要)

https://github.com/awake1t/linglong

> nmap
>
> masscan

```bash
git clone https://github.com/awake1t/linglong
cd linglong
docker-compose up -d

docker container ls -a
```

web访问http://192.168.70.4:8001

> 登录账号:`linglong` 	
>
> 登录密码:`linglong5s`

| 类型        | 用户名   | 密码       |
| ----------- | -------- | ---------- |
| Web账号     | linglong | linglong5s |
| mysql数据库 | root     | linglong8s |

### 2-5 社会工程学

一些网站如天眼查等，可以提供企业关系挖掘、工商信息、商标专利、企业年报等信息查询，

可以提供企业的较为细致的信息。公司主站中会有业务方向、合作单位等信息。

#### 企业信息收集：

目标组织信息——通过企查查、天眼查并国家企业信用信息公示系统等来对企业信息进行查询，可以查到目标组织的物理地址、逻辑关系网、邮箱、子公司、联系电话等信息。

- 域名注册信息——Whois可以查看注册的域名、注册人邮箱、电话、注册商等信息。
- 客服信息——销售客服、技术支持售后客服。
- 招聘信息——官网招聘联系方式、招聘网站联系方式等。

##### 常见在线平台:

- https://www.tianyancha.com 天眼查
- https://www.qichacha.com/ 企查查
- http://www.beian.gov.cn/portal/recordQuery 公安部备案查询

#### 人员信息收集

针对人员的信息收集考虑对目标重要人员、组织架构、社会关系的收集和分析。其中重要人员主要指高管、系统管理员、运维、财务、人事、业务人员的个人电脑。

人员信息收集较容易的入口点是网站，网站中可能包含网站的开发、管理维护等人员的信息。从网站联系功能中和代码的注释信息中都可能得到的所有开发及维护人员的姓名和邮件地址及其他联系方式。

在获取这些信息后，可以在Github/Linkedin等社交、招聘网站中进一步查找这些人在互联网上发布的与目标站点有关的一切信息，分析并发现有用的信息。此外，可以对获取到的邮箱进行密码爆破的操作，获取对应的密码。

#### 信用信息查询

通过信用信息查询可获取目标组织的相关信息，包含:法定代表人、统一社会信用代码、注册号、经营范围等。常用在线查询地址

1. 国家企业信用信息公示系统: http://www.gsxt.gov.cn/index.html
2. 信用中国-个人信用查询搜索-企业信息查询搜索-统一社会信用代码查询: https://www.creditchina.gov.cn/
3. 公司的公众号、企业号、网站，员工的网盘、百度文库等可能会存在一些敏感信息，如VPN/堡垒机账号、TeamViewer账号、网络设备默认口令、服务器默认口令等。例如：深信服VPN 有一些默认的账号密码

#### 钓鱼

基于之前收集到的信息，可以使用Office/CHM/RAR/EXE等文件制作钓鱼邮件发送至目标，进一步收集信息。其中Office可以使用Office漏洞、宏、OLE对象、PPSX等方式构造利用文件。Exe可以使用特殊的Unicode控制字符来构建容易混淆的文件名。如果前期信息收集获取到了运维等人员的邮箱，可以使用运维人员的邮箱发送，如果未收集到相关的信息，可以使用伪造发送源的方式发送邮件。

#### 利用在线社工平台

利用在线社工平台进行信息收集。

1. https://www.reg007.com/
2. https://namechk.com/
3. https://www.blackbookonline.info/
4. https://aleph.occrp.org/
5. https://monitor.firefox.com/ 
6. https://ghostproject.fr/

### 2-6 网站服务器

#### 操作系统

##### 1、大小写

将首页或者其他页面通过修改大小写辨别网站所使用的系统：

- 区分大小写（页面报错）--`Linux`
- 不区分大小写（页面正常）--`Windows`

##### 2、ICMP协议查看ttl值

- windows系统默认ttl值`128`
- linux默认ttl值64

#### 服务器-端口服务

通过端口扫描可以判断出网站开启的服务，范围从`0`到`65535`（2 ^ 16 - 1 ）。

- 开放端口--开放代表可通信，端口开放服务
- 服务类型探测--服务类型决定了该服务可能存在的漏洞
- 端口协议--自定义端口可迷惑扫描器，需要根据返回信息判断协议

##### 计算机常见的端口号包括：

- `FTP`默认端口号为：21/tcp
- `SSH`（安全登录）、`SCP`（文件传输）、端口号重定向，默认端口号为：22/tcp
- `Telnet`（远程登录）默认端口号为：23/tcp
- `SMTP`（E-mail）默认端口号为：25/tcp
- `TFTP`（Trivial File Transfer Protocol）默认端口号为：69/udp
- `HTTP`服务器默认端口号为：80/tcp
- `POP3` Post Office Protocol（E-mail）默认端口号为：110/tcp
- `HTTPS`服务器默认端口号为：443/tcp、443/udp
- `TOMCAT`默认端口号为：8080
- `Webshpere`应用程序默认端口号为：9080
- `WIN2003`远程登录默认端口号为：3389
- `MySQL`数据库默认端口号为：3306
- `Oracle` 数据库默认的端口号为：1521
- `MSSQL*SERVER`数据库server默认的端口号为：1433/tcp、1433/udp

在计算机中每个端口代表一个服务，在Windows命令行（需要管理员权限打开）中使用 

```cmd
netstat -ano |netstat -anbo
```

显示开放端口。

##### 在线网站探测方法

在线网站：http://tool.chinaz.com/port/

地址：http://coolaf.com/tool/port

##### 端口扫描：

###### masscan

使用方法：

```bash
masscan -p80 目标ip
```

###### 御剑端口扫描工具

###### nc的作用

- 实现任意TCP/UDP端口的侦听
- 端口的扫描
- 机器之间传输文件
- 机器之间网络测速

```bash
nc -v IP Port //扫描指定主机的单一端口是否开放

nc -v -z IP StartPort - EndPort //扫描指定主机的某个端口段的端口开放信息
nc -v -z -u IP StartPort - EndPort //扫描指定主机的某个UDP端口段，并且返回端口信息
```

###### nmap

是安全渗透领域最强大的开源端口扫描器，支持跨平台运行。

nmap参数

```
-T 设置速度等级，1到5级，数字越大，速度越快
-A 综合扫描
-v 输出扫描过程
-sV 扫描系统和服务版本
-O 扫描操作系统版本
--version-light做轻量级扫描
-sS TCP半连接扫描
-sU UDP 扫描
-p 指定端口范围，默认扫描1000个端口
-Pn不做ping扫描
-sn只做ping扫描，不做端口扫描
-F fast模式，只扫描常见服务端口，比默认端口（1000个）还要少
```

nmap扫描示例：

```
主机发现 nmap -sn 192.168.1.0/24
端口扫描 nmap -sS -p1-1000 192.168.10.136
系统扫描 nmap -O 192.168.10.136
版本扫描 nmap -sV 192.168.10.136
综合扫描 nmap -A 192.168.10.136
```

##### nmap脚本扫描

脚本存放路径：

```
root@kali:/usr/share/nmap/scripts

nmap --script=default 192.168.96.136
nmap --script=auth 192.168.96136
nmap --script=brute 192.168.96.136
nmap --script=vuln 192.168.96.136
```



```bash
Intense scan //强烈扫描
nmap -T4 -A -v 192.168.10.1
-T 设置速度等级，1到5级，数字越大，速度越快
-A 综合扫描
-v 输出扫描过程

Intense scan plus UDP //使用udp强烈扫描
nmap -sS -sU -T4 -A -v 192.168.10.136
-sS TCP全连接扫描
-sU UDP 扫描

Intense scan, all TCP ports //强烈扫描所有的tcp端口
nmap -p 1-65535 -T4 -A -v 192.168.10.136
-p 指定端口范围，默认扫描1000个端口

Intense scan, no ping //强烈扫描但不使用ping扫描
nmap -T4 -A -v -Pn 192.168.10.136/24
-Pn不做ping扫描，例如针对防火墙等安全产品。

Ping scan //ping扫描
nmap -sn 192.168.10.0/24
nmap -sn -T4 -v 192.168.10.0/24
-sn只做ping扫描，不做端口扫描

Quick scan //快速扫描
nmap -T4 -F 192.168.10.136
-F fast模式，只扫描常见服务端口，比默认端口（1000个）还要少

Quick scan plus //快速扫描+
nmap -sV -T4 -O -F --version-light 192.168.10.136
-sV 扫描系统和服务版本
-O 扫描操作系统版本
--version-light做轻量级扫描
Quick traceroute //快速路由扫描
nmap -sn --traceroute www.cisp.org.cn
Regular scan //正规扫描
nmap www.nisp.org.cn
Slow comprehensive scan //慢速全面扫描
nmap -sS -sU -T4 -A -v -PE -PP -PS80,443 -PA3389 -PU40125 -PY -g 53 --script "default or (discovery and safe)" www.cisp.org.cn
```

###### 全扫描

扫描主机尝试使用三次握手与目标主机的某个端口建立正规的连接，若成功建立连接，则端口处于开放状态，反之处于关闭状态。全扫描实现简单，且以较低的权限就可以进行该操作。但是在流量日志中会有大量明显的记录。

###### 半扫描

在半扫描中，仅发送SYN数据段，如果应答为RST，则端口处于关闭状态，若应答为SYN/ACK，则端口处于监听状态。不过这种方式需要较高的权限，而且部分防火墙已经开始对这种扫描方式做处理。

###### FIN扫描

FIN扫描是向目标发送一个FIN数据包，如果是开放的端口，会返回RST数据包，关闭的端口则不会返回数据包，可以通过这种方式来判断端口是否打开。这种方式并不在TCP三次握手的状态中，所以不会被记录，相对SYN扫描要更隐蔽一些。

###### 防火墙/IDS规避和欺骗

```bash
-sS 使用TCP的SYN进行扫描
-sF 使用FIN扫描
-f 报文分段
-g 使用指定的本机端口
--proxies <url,port> 使用HTTP/SOCK4代理
-data 想发送的数据包中追加自定义的负载
--data-string 将自定义的ACSII字符串附加到发送数据包中
--data-length 发送数据包时，附加随机数据
--spoof-mac MAC地址欺骗
--badsum 发送带有虚假TCP/UNP/STCP校验和的数据包
```

##### goby

###### GOBY--REDTEAM_1288_POCS

链接：https://pan.quark.cn/s/a7dd0acc825c

提取码：NE3W

> GOBY--REDTEAM_1288_POCS\goby\golib\exploits\user

###### 240807pocs

链接：https://pan.quark.cn/s/e1ce839a4473

提取码：4s3n

###### 棱镜X

链接：https://pan.quark.cn/s/3a3b888708e4

提取码：7cTk

https://prismx.io/guide/

```bash
wget https://oss.prismx.io/lib.zip
wget https://oss.prismx.io/prismx_linux_amd64
unzip lib.zip
chmod +x prismx_linux_amd64
./prismx_linux_amd64
```

> https://192.168.70.4:443 即可进入登录页，使用 `-port` 参数可指定端口。
>
> 系统默认账号：prismx / prismx@passw0rd

##### 端口信息利用示例

###### 21端口

- 基础爆破：ftp爆破工具很多，推hydra以及msf中的ftp爆破模块。
- ftp匿名访问：用户名：anonymous 密码：anonymous、为空或者任意邮箱
- 后门vsftpd ：version 2到2.3.4存在后门漏洞，攻击者可以通过该漏洞获取root权限。
- 嗅探：ftp使用明文传输技术,使用Cain进行渗透。
- ftp远程代码溢出。（ProFTPD1.3.3c）

###### 22端口

- 弱口令，可使用工具hydra，msf中的ssh爆破模块。
- openssh 用户枚举 CVE-2018-15473。
- SSH隧道及内网代理转发

###### 23端口

- 暴力破解技术是常用的技术，使用hydra, msf中爆破模块。
- 嗅探

###### SMTP (25/TCP)

- 无认证时可伪造发件人

###### 139/445端口

- MS17010永恒之蓝
- MS06040或MS08067
- 内网IPC$进行渗透

###### 3306/1433/1521/5432/6379

- 注入、提权、弱口令、反弹shell、未授权
- CVE-2014-2669 postgresql

###### 3389端口

- 查看前人shift后门（需要windows sever 2003 以下的系统）。
- 爆破
- MS12_020蓝屏

###### 7001/7002端口

- 弱口令爆破，weblogic/Oracle@123 or weblogic
- CVE-2014-4210/ CVE-2017-10271/CVE-2018-2628/CVE-2019-2725等一些列CVE

###### 8080端口

- Tomcat任意文件上传CVE-2017-12615
- Tomcat远程代码执行&信息泄露CVE-2017-12615&CVE-2017-12616
- Jboss远程代码执行&反序列化漏洞CVE-2017-12149&CVE-2017-7504
- JBoss远程部署漏洞

##### 表格

| 端口号         | 服务                   | 弱点                                                         |
| -------------- | ---------------------- | ------------------------------------------------------------ |
| 21/69          | FTP/TFTP               | 匿名上传、下载，弱口令爆破                                   |
| 22             | SSH                    | 弱口令爆破，SSH隧道及内网代理转发，文件传输                  |
| 23             | Telnet                 | 弱口令爆破，嗅探                                             |
| 25             | SMTP                   | 邮件伪造                                                     |
| 53             | DNS域名系统            | 允许区域传送、DNS劫持、缓存投毒、欺骗                        |
| 67,68          | DHCP                   | DHCP劫持、欺骗                                               |
| 80-90          | WEB                    | 常见web漏洞以及是否为一些管理后台                            |
| 110            | POP3协议               | 爆破、嗅探                                                   |
| 111            | NFS                    | 是否匿名访问                                                 |
| 139            | Samba服务              | 爆破、未授权访问、远程代码执行                               |
| 143            | IMAP协议               | 爆破                                                         |
| 161            | SNMP                   | 弱口令爆破、搜集目标内网信息                                 |
| 389            | LDAP目录访问协议       | 是否匿名访问，注入允许，弱口令                               |
| 443            | OpenSSL                | 心脏滴血以及一些web漏洞测试                                  |
| 445            | SMB                    | 弱口令爆破，检测是否有ms_08067或者ms17_010等漏洞             |
| 512,513,514    | Rexec                  | 爆破、Rlogin登陆                                             |
| 873,875        | Rsync                  | 主要看是否支持匿名，也可以跑弱口令，还有rsync未授权访问漏洞  |
| 1025           | RPC                    | NFS匿名访问                                                  |
| 1099           | JAVArmi                | 远程命令执行,rmi反序列化漏洞                                 |
| 1352           | Lotus domino邮件服务   | 可能存在弱口令、信息泄露                                     |
| 1433           | MSSQL                  | 注入、提权、SA弱口令、爆破                                   |
| 1521           | Oracle                 | 弱口令爆破、TNS爆破、注入、反弹Shell                         |
| 1900           | bes                    | bes默认管理后台                                              |
| 2049           | NFS                    | 可能存在NFS配置不当                                          |
| 2082,2083      | cpanel主机管理系统登陆 | 弱口令爆破                                                   |
| 2181           | ZooKeeper监听端口      | 可能存在ZooKeeper未授权访问漏洞                              |
| 2222           | DA虚拟主机管理系统登陆 | 弱口令爆破                                                   |
| 2375           | Docker                 | 可能存在Docker未授权访问漏洞                                 |
| 2601,2604      | zebra路由              | 默认密码zebra                                                |
| 3128           | squid代理默认端口      | 匿名访问，可能漫游内网                                       |
| 3306           | MySQL                  | 弱口令、提权、爆破                                           |
| 3311,3312      | kangle主机管理系统登陆 | 说明                                                         |
| 3389           | 远程桌面服务           | 弱口令，输入法漏洞，shirt后门，找放大镜，CVE-2019-0708远程桌面漏洞，ms12-020 |
| 3690           | SVN                    | 可能存在SVN泄漏，未授权访问漏洞                              |
| 4440           | rundeck                | 参考漏洞: 借用新浪某服务成功漫游新浪内网                     |
| 4750           | BMC                    | 可能存在BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)   |
| 4848           | ClassFish              | web中间件，弱口令admin/adminadmin                            |
| 5000           | SysBase/DB2数据库      | 可能存在爆破、注入漏洞                                       |
| 5432           | PostgreSQL数据库       | 弱口令爆破、注入漏洞                                         |
| 5560,7778      | iSqlPlus               | VNC访问                                                      |
| 5632           | PyAnywhere             | 可能存在代码执行漏洞                                         |
| 5900,5901,5902 | VNC                    | 弱口令爆破，可能存在VNC未授权访问漏洞，拒绝服务攻击（CVE-2015-5239），权限提升（CVE-2013-6886） |
| 5984           | CouchDB                | 可能存在CouchDB未授权访问漏洞                                |
| 6082           | varnish                | 参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网 |
| 6379           | redis数据库            | 一般无认证，可直接访问，可能存在Redis未授权访问漏洞          |
| 6390           | Svn服务                | Svn泄露、未授权访问                                          |
| 7001,7002      | Weblogic               | 默认弱口令，可能存在Weblogic反序列化漏洞                     |
| 7778           | Kloxo                  | Kloxo主机控制面板登录                                        |
| 8000-9090      | WEB                    | 都是一些常见的web端口，有些运维喜欢把管理后台开在这些非80的端口上 |
| 8069           | Zabbix                 | 可能存在Zabbix弱口令导致的Getshell漏洞                       |
| 8080           | Tomcat                 | 默认弱口令，Tomcat版本漏洞，低版本的utf8 directory traversal可以读取任意文件 |
| 8080,8089,9090    | JBOSS                      | 后台可能不认证，JBOSS版本漏洞,也可弱口令，未授权访问漏洞     |
| 8083              | Vestacp                    | 主机管理系统（国外用较多）                                   |
| 8089              | Jetty、Jenkins             | 可能存在反序列化，控制台弱口令等漏洞                         |
| 8161              | Apache ActiveMQ            | 可能存在CVE-2016-3088漏洞，默认口令密码为：admin:admin，Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088） |
| 8649              | ganglia                    |                                                              |
| 8888              | amh/LuManager              | 主机管理系统默认端口                                         |
| 9000              | fcgi                       | fcgi php执行                                                 |
| 9001              | Supervisord                | 可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)          |
| 9043/9090         | Websphere                  | 内存泄露,可能存在WebSphere反序列化漏洞                       |
| 9200/9300         | elasticsearch              | 代码执行,可能存在Elasticsearch未授权访问漏洞                 |
| 9090              | WebShpere控制台            | Java反序列化、弱口令                                         |
| 10000             | Virtualmin/Webmin          | 服务器虚拟主机管理系统可能存在弱口令                         |
| 10001/10002       | JmxRemoteLifecycleListener | 可能存在Tomcat反序列化漏洞(CVE-2016-8735)                    |
| 11211             | Memcache                   | 未授权访问                                                   |
| 27017,27018       | Mongodb                    | 未授权访问                                                   |
| 28017             | mongodb                    | 统计页面                                                     |
| 50000             | SAP Management Console     | 远程代码执行                                                 |
| 50030,50060,50070 | HaDoop                     | 未授权访问                                                   |

#### 常见网络安全设备默认口令

| 设备                                  | 默认账号                                  | 默认密码                                     |
| ------------------------------------- | ----------------------------------------- | -------------------------------------------- |
| 深信服产品                            | sangfor                                   | sangfor, sangfor@2018, sangfor@2019          |
| 深信服科技 AD                         | dlanrecover                               |                                              |
| 深信服负载均衡 AD 3.6                 | admin                                     | admin                                        |
| 深信服WAC (WNS V2.6)                  | admin                                     | admin                                        |
| 深信服VPN                             | Admin                                     | Admin                                        |
| 深信服ipsec-VPN (SSL5.5)              | Admin                                     | Admin                                        |
| 深信服AC6.0                           | admin                                     | admin                                        |
| SANGFOR防火墙                         | admin                                     | sangfor                                      |
| 深信服AF(NGAF V2.2)                   | admin                                     | sangfor                                      |
| 深信服NGAF下一代应用防火墙(NGAF V4.3) | admin                                     | admin                                        |
| 深信服AD3.9                           | admin                                     | admin                                        |
| 深信服上网行为管理设备数据中心        | Admin                                     | 密码为空                                     |
| SANGFOR_AD_v5.1                       | admin                                     | admin                                        |
| 网御漏洞扫描系统                      | leadsec                                   | leadsec                                      |
| 天阗入侵检测与管理系统V7.0            | Admin, Audit, adm                         | venus70                                      |
| 天阗入侵检测与管理系统V6.0            | Admin, Audit, adm                         | venus60                                      |
| 网御WAF集中控制中心(V3.0R5.0)         | admin, audit, adm                         | leadsec.waf                                  |
| 联想网御                              | administrator                             | administrator                                |
| 网御事件服务器                        | admin                                     | admin123                                     |
| 联想网御防火墙PowerV                  | administrator                             | administrator                                |
| 联想网御入侵检测系统                  | lenovo                                    | default                                      |
| 网络卫士入侵检测系统                  | admin                                     | talent                                       |
| 网御入侵检测系统V3.2.72.0             | adm, admin                                | leadsec32                                    |
| 联想网御入侵检测系统IDS               | root, admin                               | 111111, admin123                             |
| 科来网络回溯分析系统                  | csadmin                                   | colasoft                                     |
| 中控考勤机web3.0                      | administrator                             | 123456                                       |
| H3C iMC                               | admin                                     | admin                                        |
| H3C SecPath系列                       | admin                                     | admin                                        |
| H3C S5120-SI                          | test                                      | 123                                          |
| H3C智能管理中心                       | admin                                     | admin                                        |
| H3C ER3100                            | admin                                     | adminer3100                                  |
| H3C ER3200                            | admin                                     | adminer3200                                  |
| H3C ER3260                            | admin                                     | adminer3260                                  |
| H3C                                   | admin, h3c                                | adminer, admin, h3capadmin, h3c              |
| 360天擎                               | admin                                     | admin                                        |
| 网神防火墙                            | firewall                                  | firewall                                     |
| 天融信防火墙NGFW4000                  | superman                                  | talent                                       |
| 黑盾防火墙                            | admin, rule, audit                        | admin, abc123                                |
| 华为防火墙                            | telnetuser, ftpuser                       | telnetpwd, ftppwd                            |
| 方正防火墙                            | admin                                     | admin                                        |
| 飞塔防火墙                            | admin                                     | 密码为空                                     |
| Juniper_SSG__5防火墙                  | netscreen                                 | netscreen                                    |
| 中新金盾硬件防火墙                    | admin                                     | 123                                          |
| kill防火墙(冠群金辰)                  | admin                                     | sys123                                       |
| 天清汉马USG防火墙                     | admin, Audit, useradmin                   | venus.fw, venus.audit, venus.user            |
| 阿姆瑞特防火墙                        | admin                                     | manager                                      |
| 山石网科                              | hillstone                                 | hillstone                                    |
| 绿盟安全审计系统                      | weboper, webaudit, conadmin, admin, shell | weboper, webaudit, conadmin, admin, shell    |
| 绿盟产品                              |                                           | nsfocus123                                   |
| TopAudit日志审计系统                  | superman                                  | talent                                       |
| LogBase日志管理综合审计系统           | admin                                     | safetybase                                   |
| 网神SecFox运维安全管理与审计系统      | admin                                     | !1fw@2soc#3vpn                               |
| 天融信数据库审计系统                  | superman                                  | telent                                       |
| Hillstone安全审计平台                 | hillstone                                 | hillstone                                    |
| 网康日志中心                          | ns25000                                   | ns25000                                      |
| 网络安全审计系统（中科新业）          | admin                                     | 123456                                       |
| 天玥网络安全审计系统                  | Admin                                     | cyberaudit                                   |
| 明御WEB应用防火墙                     | admin                                     | admin, adminadmin                            |
| 明御攻防实验室平台                    | root                                      | 123456                                       |
| 明御安全网关                          | admin                                     | adminadmin                                   |
| 明御运维审计与册风险控制系统          | admin, system, auditor, operator          | 1q2w3e, 1q2w3e4r                             |
| 明御网站卫士                          | sysmanager                                | sysmanager888                                |
| 亿邮邮件网关                          | eyouuser, eyougw, admin                   | eyou_admin, admin@(eyou), +-ccccc, cyouadmin |
| Websense邮件安全网关                  | administrator                             | admin                                        |
| 梭子鱼邮件存储网关                    | admin                                     | admin                                        |

### 2-7 网站架构

#### 网站容器

Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本<0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞。

- nmap --script=vuln ip
- whatweb

##### 判断方法：

- http返回消息中server字段
- F12-->Network查看
- 根据报错信息判断

curl命令查询头信息

```
curl https://www.baidu.com -i
curl http://www.baidu.com -i >C:/ip.txt
```

#### 数据库

Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb 一般是asp的网页文件用access数据库。

SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf。

MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，

MySQL数据库大部分是php的页面。默认端口是3306。

Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统,常用于比较大的网站。默认端口是1521。

##### 常见数据库默认端口：

-   Oracle --- 1521
-  MySQL --- 3306
-  SQL Server --- 1433
-  DB2 --- 5000
-  PostgreSQL --- 5432
-  MongoDB --- 27017
-  Redis --- 6379

#### 编程语言(php/jsp/asp/aspx)

通过查看首页文件后缀。

通过爬虫工具爬取网站目录判断网站脚本类型。

通过`wappalyzer`插件判断。

-  PHP是一种跨平台的服务器端的嵌入式脚本语言。它大量地借用C、Java 和 Perl 语言的语法，并耦合PHP自己的特性，使WEB开发者能够快速地写出动态产生页面。它支持目前绝大多数数据库。还有一点，PHP是完全免费的，不用花钱，你可以从PHP官方站点自由下载。而且你可以不受限制地获得源码，甚至可以从中加进你自己需要的特色。PHP脚本语言的文件后缀名是 .php。
- JSP是Sun公司推出的新一代网站开发语言，Sun公司借助自己在Java上的不凡造诣，将Java从Java应用程序和JavaApplet之外，又有新的硕果，就是JSP，JavaServerPage。JSP可以在Serverlet和JavaBean的支持下，完成功能强大的站点程序。JSP脚本语言的文件后缀名是 .jsp。ASP全名ActiveServerPages，是MicroSoft公司开发的服务器端脚本环境，是一个WEB服务器端的开发环境，利用它可以产生和执行动态的、互动的、高性能的WEB服务应用程序。ASP采用脚本语言VBScript（Javascript）作为自己的开发语言。asp文件后缀名是 .asp。
- ASP.net又称为ASP+，不仅仅是ASP的简单升级，而是微软公司推出的新一代脚本语言。他不是asp的简单升级，因为他的编程方法和asp有很大的不同，他是在服务器端靠服务器编译执行的程序代码。ASP 使用脚本语言，每次请求的时候，服务器调用脚本解析引擎来解析执行其中的程序代码，而ASP.NET 则可以使用多种语言编写，而且是全编译执行的，比ASP 快，而且，不仅仅是快的问题，有很多优点。ASP.NET基于.NET Framework的Web开发平台，不但吸收了ASP以前版本的最大优点并参照Java、VB语言的开发优势加入了许多新的特色，同时也修正了以前的ASP版本的运行错误。 他还支持很多语言的编写，比如java、c#、vb.net ，功能很强。 asp.net的文件后缀名是 .aspx。

#### 常见的网站架构

```bash
windows--IIS--access--asp
windows--IIS--sqlserver--aspx
linux--apache--mysql--php
linux--nginx--mysql--php
unix--weblogic--oracle--jsp
```

